{"version":3,"sources":["uni-app:///main.js",null,"webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/order/detail.vue?b259","webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/order/detail.vue?dd83","webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/order/detail.vue?503c","uni-app:///pages/order/detail.vue","webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/order/detail.vue?f63e","webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/order/detail.vue?3b9a"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","CustomNavBar","data","id","userId","orderData","loading","computed","orderInfo","orderItems","methods","loadDetail","console","orderId","loadOrderDetailDirect","uni","url","method","header","config","success","title","icon","fail","complete","getProductImage","getStatusText","getStatusDescription","getStatusClass","getStatusEmoji","copyOrderId","payOrder","content","cancelOrder","completeOrder","formatTime","goToShop","goBack","delta","onLoad"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,eAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmH;AACnH;AAC0D;AACL;AACa;;;AAGlE;AAC6K;AAC7K,gBAAgB,iLAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,iFAAM;AACR,EAAE,0FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAqpB,CAAgB,ooBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACgIzqB;AAEA;AAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eAEA;EACAC;IAAAC;EAAA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC,0CACA;IAEA;IACAC;MACA;MACA;QACA;MACA;;MAEA;MACA;QACA;MACA;MAEA;IACA;IAEA;IACAC;MACA;;MAEA;MACA;QACA;MACA;;MAEA;MACA;QACA;MACA;MAEA;QACA;MACA;MAEA;IACA;EAAA,EACA;EACAC,yCACA;IAEAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBACAC;gBAAA;gBAAA;gBAAA,OAIA;kBAAAC;kBAAAT;gBAAA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAQ;cAAA;gBAGA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACAE;MAAA;MACA;MAEAC;QACAC;QACAC;QACAf;UACAW;UACAT;QACA;QACAc;UACA;QAAA,GACAC,+BACA;QACAC;UACAR;UACA;YACA;UACA;YAAA;YACAG;cACAM;cACAC;YACA;UACA;QACA;QACAC;UACAX;UACAG;YACAM;YACAC;UACA;QACA;QACAE;UACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MACA;;MAEA;MACA;IACA;IAEA;IACAC;MACA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;MAAA;IAEA;IAEA;IACAC;MACA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;MAAA;IAEA;IAEA;IACAC;MACA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;MAAA;IAEA;IAEA;IACAC;MACA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;MAAA;IAEA;IAEA;IACAC;MACA;MAEAf;QACAb;QACAkB;UACAL;YACAM;YACAC;UACA;QACA;MACA;IACA;IAEA;IACAS;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBACAhB;kBACAM;kBACAW;kBACAZ;oBAAA;sBAAA;wBAAA;0BAAA;4BAAA;8BACA;gCACAL;kCACAM;gCACA;gCAEA;kCACA;kCACAN;oCACAC;oCACAC;oCACAC;sCACA;oCAAA,GACAC,+BACA;oCACAC;sCACAL;sCACA;wCACAA;0CACAM;0CACAC;wCACA;wCACA;sCACA;wCAAA;wCACAP;0CACAM;0CACAC;wCACA;sCACA;oCACA;oCACAC;sCACAR;sCACAH;sCACAG;wCACAM;wCACAC;sCACA;oCACA;kCACA;gCACA;kCACAP;kCACAH;kCACAG;oCACAM;oCACAC;kCACA;gCACA;8BACA;4BAAA;4BAAA;8BAAA;0BAAA;wBAAA;sBAAA;oBAAA,CACA;oBAAA;sBAAA;oBAAA;oBAAA;kBAAA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACAW;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBACAlB;kBACAM;kBACAW;kBACAZ;oBAAA;sBAAA;wBAAA;0BAAA;4BAAA;8BACA;gCACAL;kCACAM;gCACA;gCAEA;kCACA;kCACAN;oCACAC;oCACAC;oCACAC;sCACA;oCAAA,GACAC,+BACA;oCACAC;sCACAL;sCACA;wCACAA;0CACAM;0CACAC;wCACA;wCACA;sCACA;wCAAA;wCACAP;0CACAM;0CACAC;wCACA;sCACA;oCACA;oCACAC;sCACAR;sCACAH;sCACAG;wCACAM;wCACAC;sCACA;oCACA;kCACA;gCACA;kCACAP;kCACAH;kCACAG;oCACAM;oCACAC;kCACA;gCACA;8BACA;4BAAA;4BAAA;8BAAA;0BAAA;wBAAA;sBAAA;oBAAA,CACA;oBAAA;sBAAA;oBAAA;oBAAA;kBAAA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACAY;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBACAnB;kBACAM;kBACAW;kBACAZ;oBAAA;sBAAA;wBAAA;0BAAA;4BAAA;8BACA;gCACAL;kCACAM;gCACA;gCAEA;kCACA;kCACAN;oCACAC;oCACAC;oCACAC;sCACA;oCAAA,GACAC,+BACA;oCACAC;sCACAL;sCACA;wCACAA;0CACAM;0CACAC;wCACA;wCACA;sCACA;wCAAA;wCACAP;0CACAM;0CACAC;wCACA;sCACA;oCACA;oCACAC;sCACAR;sCACAH;sCACAG;wCACAM;wCACAC;sCACA;oCACA;kCACA;gCACA;kCACAP;kCACAH;kCACAG;oCACAM;oCACAC;kCACA;gCACA;8BACA;4BAAA;4BAAA;8BAAA;0BAAA;wBAAA;sBAAA;oBAAA,CACA;oBAAA;sBAAA;oBAAA;oBAAA;kBAAA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACAa;MACA;MAEA;QACA;QACA;MACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MAEArB;QACAC;QACAO;UACAX;UACAG;YACAM;YACAC;UACA;QACA;MACA;IACA;IAEA;IACAe;MACAtB;QACAuB;QACAf;UACAR;YACAC;UACA;QACA;MACA;IACA;EAAA,EACA;EACAuB;IACA;IACA;IACA;IACA;MACA;IACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC7gBA;AAAA;AAAA;AAAA;AAA47B,CAAgB,i4BAAG,EAAC,C;;;;;;;;;;;ACAh9B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/order/detail.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/order/detail.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./detail.vue?vue&type=template&id=57d42baa&\"\nvar renderjs\nimport script from \"./detail.vue?vue&type=script&lang=js&\"\nexport * from \"./detail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./detail.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/order/detail.vue\"\nexport default component.exports","export * from \"-!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=template&id=57d42baa&\"","var render = function () {}\nvar staticRenderFns = []\nvar recyclableRender\nvar components\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"container\">\r\n    <custom-nav-bar title=\"订单详情\" :show-back=\"true\"></custom-nav-bar>\r\n    \r\n    <!-- 加载中状态 -->\r\n    <view v-if=\"isLoading || loading\" class=\"loading-container\">\r\n      <view class=\"loading-spinner\"></view>\r\n      <text class=\"loading-text\">加载订单详情中...</text>\r\n    </view>\r\n    \r\n    <!-- 订单不存在状态 -->\r\n    <view v-else-if=\"!orderInfo\" class=\"empty-container\">\r\n      <image class=\"empty-icon\" src=\"/static/images/empty-order.png\" mode=\"aspectFit\"></image>\r\n      <text class=\"empty-title\">未找到订单信息</text>\r\n      <view class=\"empty-desc\">订单ID: {{id}}</view>\r\n      <button class=\"primary-btn\" @click=\"goBack\">返回</button>\r\n    </view>\r\n    \r\n    <!-- 订单详情内容 -->\r\n    <block v-else>\r\n      <scroll-view scroll-y class=\"order-scroll\">\r\n        <!-- 订单状态卡片 -->\r\n        <view class=\"status-card\">\r\n          <view class=\"status-icon\" :class=\"getStatusClass(orderInfo.status)\">\r\n            <text class=\"status-emoji\">{{getStatusEmoji(orderInfo.status)}}</text>\r\n          </view>\r\n          <view class=\"status-info\">\r\n            <text class=\"status-text\">{{getStatusText(orderInfo.status)}}</text>\r\n            <text class=\"status-desc\">{{getStatusDescription(orderInfo.status)}}</text>\r\n          </view>\r\n        </view>\r\n        \r\n        <!-- 订单信息卡片 -->\r\n        <view class=\"order-card\">\r\n          <view class=\"section-title\">订单信息</view>\r\n          <view class=\"info-row\">\r\n            <text class=\"info-label\">订单编号</text>\r\n            <view class=\"info-value-copy\">\r\n              <text class=\"info-value\">{{orderInfo.id}}</text>\r\n              <text class=\"copy-btn\" @click=\"copyOrderId\">复制</text>\r\n            </view>\r\n          </view>\r\n          <view class=\"info-row\">\r\n            <text class=\"info-label\">下单时间</text>\r\n            <text class=\"info-value\">{{formatTime(orderInfo.createTime)}}</text>\r\n          </view>\r\n          <view class=\"info-row\" v-if=\"orderInfo.payTime\">\r\n            <text class=\"info-label\">支付时间</text>\r\n            <text class=\"info-value\">{{formatTime(orderInfo.payTime)}}</text>\r\n          </view>\r\n          <view class=\"info-row\" v-if=\"orderInfo.cancelTime\">\r\n            <text class=\"info-label\">取消时间</text>\r\n            <text class=\"info-value\">{{formatTime(orderInfo.cancelTime)}}</text>\r\n          </view>\r\n          <view class=\"info-row\">\r\n            <text class=\"info-label\">支付方式</text>\r\n            <text class=\"info-value\">微信支付</text>\r\n          </view>\r\n        </view>\r\n        \r\n        <!-- 商品列表卡片 -->\r\n        <view class=\"order-card\">\r\n          <view class=\"section-title\">商品信息</view>\r\n          <view class=\"product-list\">\r\n            <view v-for=\"(item, index) in orderItems\" :key=\"index\" class=\"product-item\">\r\n              <image class=\"product-image\" :src=\"getProductImage(item)\" mode=\"aspectFill\"></image>\r\n              <view class=\"product-info\">\r\n                <text class=\"product-name\">{{item.productName}}</text>\r\n                <view class=\"product-price-row\">\r\n                  <text class=\"product-price\">¥{{item.price}}</text>\r\n                  <text class=\"product-quantity\">x{{item.quantity}}</text>\r\n                </view>\r\n              </view>\r\n            </view>\r\n          </view>\r\n          \r\n          <!-- 价格明细 -->\r\n          <view class=\"price-summary\">\r\n            <view class=\"price-row\">\r\n              <text>商品总额</text>\r\n              <text>¥{{orderInfo.totalAmount}}</text>\r\n            </view>\r\n            <view class=\"price-row\" v-if=\"orderInfo.totalAmount !== orderInfo.payAmount\">\r\n              <text>优惠金额</text>\r\n              <text class=\"discount-price\">-¥{{orderInfo.totalAmount - orderInfo.payAmount}}</text>\r\n            </view>\r\n            <view class=\"price-row total\">\r\n              <text>实付金额</text>\r\n              <text class=\"total-price\">¥{{orderInfo.payAmount}}</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n        \r\n        <!-- 收货信息卡片 -->\r\n        <view class=\"order-card\" v-if=\"orderInfo.address || orderInfo.phone\">\r\n          <view class=\"section-title\">收货信息</view>\r\n          <view class=\"info-row\" v-if=\"orderInfo.address\">\r\n            <text class=\"info-label\">收货地址</text>\r\n            <text class=\"info-value address\">{{orderInfo.address}}</text>\r\n          </view>\r\n          <view class=\"info-row\" v-if=\"orderInfo.phone\">\r\n            <text class=\"info-label\">联系电话</text>\r\n            <text class=\"info-value\">{{orderInfo.phone}}</text>\r\n          </view>\r\n        </view>\r\n        \r\n        <!-- 店铺信息卡片 -->\r\n        <view class=\"order-card\">\r\n          <view class=\"section-title\">店铺信息</view>\r\n          <view class=\"info-row\">\r\n            <text class=\"info-label\">店铺ID</text>\r\n            <text class=\"info-value\">{{orderInfo.shopId}}</text>\r\n          </view>\r\n          <button class=\"shop-btn\" @click=\"goToShop\">查看店铺</button>\r\n        </view>\r\n      </scroll-view>\r\n      \r\n      <!-- 底部操作按钮 -->\r\n      <view class=\"bottom-actions\" v-if=\"orderInfo.status !== 3\">\r\n        <button v-if=\"orderInfo.status === 0\" class=\"action-btn cancel\" @click=\"cancelOrder\">取消订单</button>\r\n        <button v-if=\"orderInfo.status === 0\" class=\"action-btn primary\" @click=\"payOrder\">立即支付</button>\r\n        <button v-if=\"orderInfo.status === 1\" class=\"action-btn primary\" @click=\"completeOrder\">确认收货</button>\r\n      </view>\r\n    </block>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapActions } from 'vuex';\r\nimport CustomNavBar from '@/components/CustomNavBar.vue';\r\nimport config from '@/config/index.js';\r\n\r\nexport default {\r\n  components: { CustomNavBar },\r\n  data() { \r\n    return { \r\n      id: null, \r\n      userId: 1,\r\n      orderData: null,\r\n      loading: false \r\n    }; \r\n  },\r\n  computed: {\r\n    ...mapState('order', ['currentOrder','isLoading']),\r\n    \r\n    // 优先使用直接API请求获取的数据\r\n    orderInfo() {\r\n      // 如果有直接获取的数据，优先使用\r\n      if (this.orderData) {\r\n        return this.orderData.order || this.orderData;\r\n      }\r\n      \r\n      // 如果有Vuex中的数据，使用Vuex数据\r\n      if (this.currentOrder) {\r\n        return this.currentOrder.order || this.currentOrder;\r\n      }\r\n      \r\n      return null;\r\n    },\r\n    \r\n    // 获取订单商品项\r\n    orderItems() {\r\n      if (!this.orderInfo) return [];\r\n      \r\n      // 处理嵌套数据结构\r\n      if (this.orderData && this.orderData.orderItems) {\r\n        return this.orderData.orderItems;\r\n      }\r\n      \r\n      // 处理其他可能的数据结构\r\n      if (this.orderInfo.items) {\r\n        return this.orderInfo.items;\r\n      }\r\n      \r\n      if (this.orderInfo.orderItems) {\r\n        return this.orderInfo.orderItems;\r\n      }\r\n      \r\n      return [];\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions('order', ['getOrderDetail','payOrder','cancelOrder','completeOrder']),\r\n    \r\n    async loadDetail() { \r\n      console.log('加载订单详情, orderId:', this.id, 'userId:', this.userId);\r\n      \r\n      try {\r\n        // 尝试使用Vuex action\r\n        await this.getOrderDetail({orderId: this.id, userId: this.userId});\r\n      } catch(error) {\r\n        console.error('Vuex加载订单详情失败:', error);\r\n      }\r\n      \r\n      // 无论Vuex是否成功，都尝试直接API调用以获取最新数据\r\n      this.loadOrderDetailDirect();\r\n    },\r\n    \r\n    // 直接通过API获取订单详情（不通过Vuex）\r\n    loadOrderDetailDirect() {\r\n      this.loading = true;\r\n      \r\n      uni.request({\r\n        url: `${config.BaseUrl}/api/shop/order/detail`,\r\n        method: 'GET',\r\n        data: {\r\n          orderId: this.id,\r\n          userId: this.userId\r\n        },\r\n        header: {\r\n          'content-type': 'application/json',\r\n          ...config.getAuthHeader()\r\n        },\r\n        success: (res) => {\r\n          console.log('直接API获取订单详情成功:', JSON.stringify(res.data));\r\n          if (res.data && res.data.code === 1) {\r\n            this.orderData = res.data.data;\r\n          } else {\r\n            uni.showToast({\r\n              title: res.data?.msg || '获取订单详情失败',\r\n              icon: 'none'\r\n            });\r\n          }\r\n        },\r\n        fail: (err) => {\r\n          console.error('直接API获取订单详情失败:', JSON.stringify(err));\r\n          uni.showToast({\r\n            title: '网络请求失败',\r\n            icon: 'none'\r\n          });\r\n        },\r\n        complete: () => {\r\n          this.loading = false;\r\n        }\r\n      });\r\n    },\r\n    \r\n    // 获取商品图片\r\n    getProductImage(item) {\r\n      // 如果商品项有图片属性，则使用\r\n      if (item.image) return item.image;\r\n      \r\n      // 否则使用默认图片\r\n      return 'https://ykhyyy.oss-cn-beijing.aliyuncs.com/ht.jpg';\r\n    },\r\n    \r\n    // 获取订单状态文本\r\n    getStatusText(status) {\r\n      switch(parseInt(status)){\r\n        case 0: return '待支付';\r\n        case 1: return '已支付';\r\n        case 2: return '已完成';\r\n        case 3: return '已取消';\r\n        default: return '未知状态';\r\n      }\r\n    },\r\n    \r\n    // 获取订单状态描述\r\n    getStatusDescription(status) {\r\n      switch(parseInt(status)){\r\n        case 0: return '请在30分钟内完成支付';\r\n        case 1: return '商家正在处理您的订单';\r\n        case 2: return '订单已完成，感谢您的购买';\r\n        case 3: return '订单已取消';\r\n        default: return '';\r\n      }\r\n    },\r\n    \r\n    // 获取状态对应的CSS类\r\n    getStatusClass(status) {\r\n      switch(parseInt(status)){\r\n        case 0: return 'status-pending';\r\n        case 1: return 'status-paid';\r\n        case 2: return 'status-completed';\r\n        case 3: return 'status-cancelled';\r\n        default: return '';\r\n      }\r\n    },\r\n    \r\n    // 获取状态对应的emoji\r\n    getStatusEmoji(status) {\r\n      switch(parseInt(status)){\r\n        case 0: return '⏱️';\r\n        case 1: return '🚚';\r\n        case 2: return '✅';\r\n        case 3: return '❌';\r\n        default: return '❓';\r\n      }\r\n    },\r\n    \r\n    // 复制订单ID\r\n    copyOrderId() {\r\n      if (!this.orderInfo || !this.orderInfo.id) return;\r\n      \r\n      uni.setClipboardData({\r\n        data: this.orderInfo.id.toString(),\r\n        success: () => {\r\n          uni.showToast({\r\n            title: '订单号已复制',\r\n            icon: 'success'\r\n          });\r\n        }\r\n      });\r\n    },\r\n    \r\n    // 支付订单\r\n    async payOrder() {\r\n      uni.showModal({\r\n        title: '订单支付',\r\n        content: '确定要支付此订单吗？',\r\n        success: async (res) => {\r\n          if (res.confirm) {\r\n            uni.showLoading({\r\n              title: '处理中...'\r\n            });\r\n            \r\n            try {\r\n              // 使用正确的API路径格式\r\n              uni.request({\r\n                url: `${config.BaseUrl}/api/shop/order/${this.userId}/${this.id}/pay`,\r\n                method: 'PUT',\r\n                header: {\r\n                  'content-type': 'application/json',\r\n                  ...config.getAuthHeader()\r\n                },\r\n                success: (res) => {\r\n                  uni.hideLoading();\r\n                  if (res.data && res.data.code === 1) {\r\n                    uni.showToast({\r\n                      title: '支付成功',\r\n                      icon: 'success'\r\n                    });\r\n                    this.loadDetail(); // 重新加载订单数据\r\n                  } else {\r\n                    uni.showToast({\r\n                      title: res.data?.msg || '支付失败',\r\n                      icon: 'none'\r\n                    });\r\n                  }\r\n                },\r\n                fail: (err) => {\r\n                  uni.hideLoading();\r\n                  console.error('支付订单请求失败:', JSON.stringify(err));\r\n                  uni.showToast({\r\n                    title: '网络请求失败',\r\n                    icon: 'none'\r\n                  });\r\n                }\r\n              });\r\n            } catch(error) {\r\n              uni.hideLoading();\r\n              console.error('支付订单失败:', error);\r\n              uni.showToast({\r\n                title: '支付处理失败',\r\n                icon: 'none'\r\n              });\r\n            }\r\n          }\r\n        }\r\n      });\r\n    },\r\n    \r\n    // 取消订单\r\n    async cancelOrder() {\r\n      uni.showModal({\r\n        title: '取消订单',\r\n        content: '确定要取消此订单吗？',\r\n        success: async (res) => {\r\n          if (res.confirm) {\r\n            uni.showLoading({\r\n              title: '处理中...'\r\n            });\r\n            \r\n            try {\r\n              // 使用正确的API路径格式\r\n              uni.request({\r\n                url: `${config.BaseUrl}/api/shop/order/${this.userId}/${this.id}/cancel`,\r\n                method: 'PUT',\r\n                header: {\r\n                  'content-type': 'application/json',\r\n                  ...config.getAuthHeader()\r\n                },\r\n                success: (res) => {\r\n                  uni.hideLoading();\r\n                  if (res.data && res.data.code === 1) {\r\n                    uni.showToast({\r\n                      title: '订单已取消',\r\n                      icon: 'success'\r\n                    });\r\n                    this.loadDetail(); // 重新加载订单数据\r\n                  } else {\r\n                    uni.showToast({\r\n                      title: res.data?.msg || '取消失败',\r\n                      icon: 'none'\r\n                    });\r\n                  }\r\n                },\r\n                fail: (err) => {\r\n                  uni.hideLoading();\r\n                  console.error('取消订单请求失败:', JSON.stringify(err));\r\n                  uni.showToast({\r\n                    title: '网络请求失败',\r\n                    icon: 'none'\r\n                  });\r\n                }\r\n              });\r\n            } catch(error) {\r\n              uni.hideLoading();\r\n              console.error('取消订单失败:', error);\r\n              uni.showToast({\r\n                title: '处理失败',\r\n                icon: 'none'\r\n              });\r\n            }\r\n          }\r\n        }\r\n      });\r\n    },\r\n    \r\n    // 完成订单\r\n    async completeOrder() {\r\n      uni.showModal({\r\n        title: '确认收货',\r\n        content: '确认已收到商品吗？',\r\n        success: async (res) => {\r\n          if (res.confirm) {\r\n            uni.showLoading({\r\n              title: '处理中...'\r\n            });\r\n            \r\n            try {\r\n              // 使用正确的API路径格式\r\n              uni.request({\r\n                url: `${config.BaseUrl}/api/shop/order/${this.userId}/${this.id}/complete`,\r\n                method: 'PUT',\r\n                header: {\r\n                  'content-type': 'application/json',\r\n                  ...config.getAuthHeader()\r\n                },\r\n                success: (res) => {\r\n                  uni.hideLoading();\r\n                  if (res.data && res.data.code === 1) {\r\n                    uni.showToast({\r\n                      title: '订单已完成',\r\n                      icon: 'success'\r\n                    });\r\n                    this.loadDetail(); // 重新加载订单数据\r\n                  } else {\r\n                    uni.showToast({\r\n                      title: res.data?.msg || '操作失败',\r\n                      icon: 'none'\r\n                    });\r\n                  }\r\n                },\r\n                fail: (err) => {\r\n                  uni.hideLoading();\r\n                  console.error('完成订单请求失败:', JSON.stringify(err));\r\n                  uni.showToast({\r\n                    title: '网络请求失败',\r\n                    icon: 'none'\r\n                  });\r\n                }\r\n              });\r\n            } catch(error) {\r\n              uni.hideLoading();\r\n              console.error('完成订单失败:', error);\r\n              uni.showToast({\r\n                title: '处理失败',\r\n                icon: 'none'\r\n              });\r\n            }\r\n          }\r\n        }\r\n      });\r\n    },\r\n    \r\n    // 格式化时间\r\n    formatTime(timeStr) {\r\n      if (!timeStr) return '未知';\r\n      \r\n      try {\r\n        const date = new Date(timeStr);\r\n        return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;\r\n      } catch (e) {\r\n        return timeStr;\r\n      }\r\n    },\r\n    \r\n    // 跳转到店铺页面\r\n    goToShop() {\r\n      if (!this.orderInfo || !this.orderInfo.shopId) return;\r\n      \r\n      uni.navigateTo({\r\n        url: `/pages/mall/shops/detail?id=${this.orderInfo.shopId}`,\r\n        fail: (err) => {\r\n          console.error('导航到店铺页面失败:', JSON.stringify(err));\r\n          uni.showToast({\r\n            title: '导航到店铺页面失败',\r\n            icon: 'none'\r\n          });\r\n        }\r\n      });\r\n    },\r\n    \r\n    // 返回上一页\r\n    goBack() {\r\n      uni.navigateBack({\r\n        delta: 1,\r\n        fail: () => {\r\n          uni.switchTab({\r\n            url: '/pages/mall/index'\r\n          });\r\n        }\r\n      });\r\n    }\r\n  },\r\n  onLoad(options) { \r\n    this.id = options.id;\r\n    // 从本地存储或全局状态中获取用户ID\r\n    const userInfo = uni.getStorageSync('userInfo');\r\n    if (userInfo && userInfo.id) {\r\n      this.userId = userInfo.id;\r\n    }\r\n    this.loadDetail(); \r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.container {\r\n  min-height: 100vh;\r\n  background-color: #F8F7F2;\r\n  display: flex;\r\n  flex-direction: column;\r\n  position: relative;\r\n  padding-bottom: 120rpx;\r\n}\r\n\r\n/* 加载状态 */\r\n.loading-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 70vh;\r\n}\r\n\r\n.loading-spinner {\r\n  width: 60rpx;\r\n  height: 60rpx;\r\n  border: 6rpx solid #f3f3f3;\r\n  border-top: 6rpx solid #8A3324;\r\n  border-radius: 50%;\r\n  animation: spin 0.8s linear infinite;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n\r\n.loading-text {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n/* 空状态 */\r\n.empty-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 70vh;\r\n}\r\n\r\n.empty-icon {\r\n  width: 200rpx;\r\n  height: 200rpx;\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.empty-title {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  margin-bottom: 10rpx;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n.empty-desc {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n  margin-bottom: 40rpx;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n.primary-btn {\r\n  background-color: #8A3324;\r\n  color: #fff;\r\n  border-radius: 40rpx;\r\n  font-size: 28rpx;\r\n  padding: 16rpx 60rpx;\r\n  border: none;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n/* 订单内容区域 */\r\n.order-scroll {\r\n  flex: 1;\r\n  height: calc(100vh - 120rpx);\r\n  padding: 30rpx 30rpx 50rpx;\r\n}\r\n\r\n/* 状态卡片 */\r\n.status-card {\r\n  background: linear-gradient(135deg, #8A3324, #a54b3c);\r\n  border-radius: 20rpx;\r\n  padding: 40rpx 30rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 30rpx;\r\n  box-shadow: 0 4rpx 12rpx rgba(138, 51, 36, 0.2);\r\n  border: 1rpx solid #e0c9d1;\r\n}\r\n\r\n.status-icon {\r\n  width: 100rpx;\r\n  height: 100rpx;\r\n  border-radius: 50%;\r\n  background-color: rgba(255, 255, 255, 0.9);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin-right: 30rpx;\r\n  border: 1rpx solid #e0c9d1;\r\n}\r\n\r\n.status-emoji {\r\n  font-size: 50rpx;\r\n}\r\n\r\n.status-info {\r\n  flex: 1;\r\n}\r\n\r\n.status-text {\r\n  font-size: 36rpx;\r\n  color: #fff;\r\n  font-weight: bold;\r\n  margin-bottom: 10rpx;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n.status-desc {\r\n  font-size: 26rpx;\r\n  color: rgba(255, 255, 255, 0.8);\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n/* 状态颜色 */\r\n.status-card.status-pending {\r\n  background: linear-gradient(135deg, #ff9800, #f57c00);\r\n}\r\n\r\n.status-card.status-paid {\r\n  background: linear-gradient(135deg, #7EC4CF, #5ba3ae);\r\n}\r\n\r\n.status-card.status-completed {\r\n  background: linear-gradient(135deg, #8A3324, #a54b3c);\r\n}\r\n\r\n.status-card.status-cancelled {\r\n  background: linear-gradient(135deg, #9e9e9e, #616161);\r\n}\r\n\r\n/* 订单卡片 */\r\n.order-card {\r\n  background-color: #fff;\r\n  border-radius: 16rpx;\r\n  padding: 30rpx;\r\n  margin-bottom: 30rpx;\r\n  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.06);\r\n  border: 1rpx solid #e0c9d1;\r\n}\r\n\r\n.section-title {\r\n  font-size: 30rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  margin-bottom: 20rpx;\r\n  padding-bottom: 16rpx;\r\n  border-bottom: 2rpx solid #f2f2f2;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n.info-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.info-label {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n.info-value {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  max-width: 70%;\r\n  text-align: right;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n.info-value.address {\r\n  word-break: break-all;\r\n}\r\n\r\n.info-value-copy {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.copy-btn {\r\n  font-size: 24rpx;\r\n  color: #8A3324;\r\n  margin-left: 10rpx;\r\n  background-color: rgba(138, 51, 36, 0.1);\r\n  padding: 4rpx 12rpx;\r\n  border-radius: 20rpx;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n/* 商品列表 */\r\n.product-list {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.product-item {\r\n  display: flex;\r\n  margin-bottom: 20rpx;\r\n  padding-bottom: 20rpx;\r\n  border-bottom: 2rpx solid #f5f5f5;\r\n}\r\n\r\n.product-item:last-child {\r\n  margin-bottom: 0;\r\n  padding-bottom: 0;\r\n  border-bottom: none;\r\n}\r\n\r\n.product-image {\r\n  width: 160rpx;\r\n  height: 160rpx;\r\n  border-radius: 12rpx;\r\n  margin-right: 20rpx;\r\n  background-color: #f5f5f5;\r\n  border: 1rpx solid #e0c9d1;\r\n}\r\n\r\n.product-info {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n}\r\n\r\n.product-name {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  margin-bottom: 10rpx;\r\n  line-height: 1.4;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n.product-price-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: flex-end;\r\n}\r\n\r\n.product-price {\r\n  font-size: 32rpx;\r\n  color: #8A3324;\r\n  font-weight: bold;\r\n}\r\n\r\n.product-quantity {\r\n  font-size: 28rpx;\r\n  color: #999;\r\n}\r\n\r\n/* 价格明细 */\r\n.price-summary {\r\n  padding-top: 20rpx;\r\n  border-top: 2rpx solid #f5f5f5;\r\n}\r\n\r\n.price-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 16rpx;\r\n  font-size: 28rpx;\r\n  color: #666;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n.price-row.total {\r\n  margin-top: 20rpx;\r\n  padding-top: 20rpx;\r\n  border-top: 2rpx dashed #f0f0f0;\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n.discount-price {\r\n  color: #8A3324;\r\n}\r\n\r\n.total-price {\r\n  font-size: 36rpx;\r\n  color: #8A3324;\r\n  font-weight: bold;\r\n}\r\n\r\n/* 店铺按钮 */\r\n.shop-btn {\r\n  margin-top: 20rpx;\r\n  background-color: #f5f5f5;\r\n  color: #666;\r\n  font-size: 28rpx;\r\n  border-radius: 40rpx;\r\n  padding: 16rpx 0;\r\n  border: none;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n/* 底部操作区 */\r\n.bottom-actions {\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  background-color: #fff;\r\n  padding: 20rpx 30rpx;\r\n  box-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.05);\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  box-sizing: border-box;\r\n  z-index: 100;\r\n  border-top: 1rpx solid #e0c9d1;\r\n}\r\n\r\n.action-btn {\r\n  font-size: 28rpx;\r\n  border-radius: 40rpx;\r\n  padding: 16rpx 40rpx;\r\n  margin-left: 20rpx;\r\n  border: none;\r\n  font-family: \"FangSong\", serif;\r\n}\r\n\r\n.action-btn.cancel {\r\n  background-color: #f5f5f5;\r\n  color: #666;\r\n  border: 1rpx solid #e0c9d1;\r\n}\r\n\r\n.action-btn.primary {\r\n  background-color: #8A3324;\r\n  color: #fff;\r\n}\r\n</style> ","import mod from \"-!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1749284683804\n      var cssReload = require(\"C:/App/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}