{"version":3,"sources":["uni-app:///main.js",null,"webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/mall/shops/detail.vue?8c6b","webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/mall/shops/detail.vue?8ee2","webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/mall/shops/detail.vue?11ad","uni-app:///pages/mall/shops/detail.vue","webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/mall/shops/detail.vue?f386","webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/mall/shops/detail.vue?80b5"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","AiAssistant","CustomNavBar","data","id","loading","loadingProducts","loadingCategories","loadingMore","loadingCoupons","shop","products","searchText","selectedCategoryId","currentPage","pageSize","totalItems","categories","coupons","showCoupons","userId","cartItems","showCartDetail","_preventNavigation","computed","hasMore","getTotalPrice","total","getTotalCount","count","onLoad","console","uni","title","icon","setTimeout","methods","loadShopDetails","url","method","header","success","shopData","fail","complete","loadProductCategories","name","loadProducts","shopId","current","size","params","selectCategory","searchProducts","loadMore","viewProductDetail","goToShopReviews","goBack","delta","loadShopCoupons","checkUserCoupons","coupon","claimCoupon","content","normalClaimCoupon","speedKillCoupon","couponId","formatCouponValue","formatCouponTime","isCouponDisabled","addToCart","price","image","quantity","increaseQuantity","decreaseQuantity","clearCart","checkout","order","totalAmount","payAmount","status","createTime","payTime","cancelTime","orderItems","orderId","productId","productName","totalPrice","config","duration","onPullDownRefresh","Promise","onReachBottom"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,eAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmH;AACnH;AAC0D;AACL;AACa;;;AAGlE;AACgL;AAChL,gBAAgB,iLAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,iFAAM;AACR,EAAE,0FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC/GA;AAAA;AAAA;AAAA;AAAoqB,CAAgB,ooBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACqQxrB;AAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eAEA;EACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;;EACAC;IACAC;MACA;IACA;IACA;IACAC;MACA;MACA;QACAC;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;QACAC;MACA;MACA;IACA;EACA;EACAC;IAAA;IACAC;IACA;IAEA;MACAA;MACAC;QACAC;QACAC;MACA;MACAC;QACA;MACA;MACA;IACA;IAEAJ;IACA;IACA;IACA;IACA;EACA;EACAK;IACA;IACAC;MAAA;MACA;MACAN;MAEAC;QACAM;QACAC;QACAC;UACA;QACA;QACAC;UACAV;UACA;YACA;YAEAA;;YAEA;YACA;cACA;cACA;gBACA;gBACA;gBACA;gBACA;gBACAW;cACA;;cAEA;cACA;gBACAA;cACA;;cAEA;cACAA;cAEAX;YACA;cACAA;YACA;YAEA;UACA;YACAA;YACAC;cACAC;cACAC;YACA;UACA;QACA;QACAS;UACAZ;UACAC;YACAC;YACAC;UACA;QACA;QACAU;UACA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MACA;MAEAb;QACAM;QACAC;QACAC;UACA;QACA;QACAC;UACAV;UACA;YACA;YACA;YACA;cAAA3B;cAAA0C;YAAA;YACA;UACA;YACAf;UACA;QACA;QACAY;UACAZ;QACA;QACAa;UACA;QACA;MACA;IACA;IAEA;IACAG;MAAA;MAAA;MACA;QACA;QACA;QACA;MACA;QACA;MACA;;MAEA;MACA;QACAC;QACAC;QACAC;MACA;;MAEA;MACA;QACAC;MACA;;MAEA;MACA;QACAA;MACA;MAEApB;MAEAC;QACAM;QACAC;QACApC;QACAqC;UACA;QACA;QACAC;UACAV;UACA;YACA;YAEA;cACA;YACA;cACA;YACA;YAEA;YACA;YAEAA;UACA;YACAA;YACAC;cACAC;cACAC;YACA;UACA;QACA;QACAS;UACAZ;UACAC;YACAC;YACAC;UACA;QACA;QACAU;UACA;UACA;QACA;MACA;IACA;IAEA;IACAQ;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;IACA;IAEA;IACAC;MACA;QACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MACA;QACAxB;QACA;QACA;MACA;MAEA;QACAC;UACAC;UACAC;QACA;QACA;MACA;MAEAF;QACAM;MACA;IACA;IAEA;IACAkB;MACA;QACAxB;UACAC;UACAC;QACA;QACA;MACA;MAEAH;MACAC;QACAM;QACAK;UACAZ;UACAC;YACAC;YACAC;UACA;QACA;MACA;IACA;IAEAuB;MACAzB;QACA0B;QACAf;UACA;UACAX;YACAM;UACA;QACA;MACA;IACA;IAEA;IACAqB;MAAA;MACA;MAEA3B;QACAM;QACAC;QACApC;UACA6C;UACAC;UACAC;QACA;QACAV;UACA;QACA;QACAC;UACAV;UACA;YACA;;YAEA;YACA;YAEA;UACA;YACAA;YACAC;cACAC;cACAC;YACA;UACA;QACA;QACAS;UACAZ;UACAC;YACAC;YACAC;UACA;QACA;QACAU;UACA;QACA;MACA;IACA;IAEA;IACAgB;MACA;MACA;MACA;MACA;QACA;QACAC;QACAA;QACAA;QACAA;QACAA;QACAA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MACA;QACA;MACA;;MAEA;MACA9B;QACAC;QACA8B;QACAtB;UACA;YACA;YACA;cACA;YACA;cACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACAuB;MAAA;MACAhC;QACAC;MACA;;MAEA;MACA;MACAE;QACAH;;QAEA;QACA;UAAA;QAAA;QACA;UACA;UACA;UACA;YACA;UACA;QACA;QAEAA;UACAC;UACAC;QACA;MACA;IACA;IAEA;IACA+B;MAAA;MACAjC;QACAC;MACA;;MAEA;MACAD;QACAM;QACAC;QACApC;UACAiB;UACA8C;QACA;QACA1B;UACA;QACA;QACAC;UACAV;UACA;YACA;YACA;cAAA;YAAA;YACA;cACA;cACA;cACA;gBACA;cACA;YACA;YAEAC;cACAC;cACAC;YACA;UACA;YACAF;cACAC;cACAC;YACA;UACA;QACA;QACAS;UACAZ;UACAC;YACAC;YACAC;UACA;QACA;QACAU;UACAZ;QACA;MACA;IACA;IAEA;IACAmC;MACA;MAEA;QACA;QACA;MACA;QACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MAEA;MACA;MAEA;MAEA;QACA;QACA;QACA;QACA;MACA;MAEA;IACA;IAEA;IACAC;MACA;MAEA;MACA;MACA;;MAEA;MACA;QACA;MACA;;MAEA;MACA;QACA;MACA;;MAEA;QACA;MACA;;MAEA;IACA;IAEA;IACAC;MACA;MACA;;MAEA;MACA;QACAvC;QACAC;UACAC;UACAC;QACA;QACA;MACA;;MAEA;MACA;;MAEA;MACA;QACAH;QACAC;UACAC;UACAC;QACA;QACA;MACA;;MAEA;MACA;QACAH;QACAC;UACAC;UACAC;QACA;QACA;MACA;MAEAH;;MAEA;MACA;QAAA;MAAA;MAEA;QACA;QACA;MACA;QACA;QACA;UACA3B;UACA0C;UACAyB;UACAC;UACAC;QACA;MACA;;MAEA;MACAzC;QACAC;QACAC;MACA;;MAEA;MACA;IACA;IAEA;IACAwC;MACA;IACA;IAEA;IACAC;MAAA;MACA;QACA;MACA;QACA;QACA3C;UACAC;UACA8B;UACAtB;YACA;cACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACAmC;MAAA;MACA5C;QACAC;QACA8B;QACAtB;UACA;YACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACAoC;MAAA;MACA;QACA7C;UACAC;UACAC;QACA;QACA;MACA;;MAEA;MACA;;MAEA;MACA;;MAEA;MACA;QACA4C;UACA1E;UAAA;UACAgB;UACA4B;UACAkB;UAAA;UACAa;UACAC;UACAC;UAAA;UACAC;UACAC;UAAA;UACAC;QACA;;QACAC;UAAA;YACAjF;YAAA;YACAkF;YAAA;YACAtC;YACAuC;YACAC;YACAf;YACAF;YACAkB;UACA;QAAA;MACA;MAEA1D;;MAEA;MACAC;QACAC;MACA;;MAEA;MACAD;QACAM;QACAC;QACApC;QACAqC;UACA;QAAA,GACAkD,+BACA;QACAjD;UACAV;UACA;YACA;;YAEA;YACA;YACA;;YAEA;YACAC;cACAC;cACAC;YACA;;YAEA;YACAC;cACA;cACA;gBACAJ;;gBAEA;gBACAC;kBACAM;kBACAG;oBACAV;kBACA;kBACAY;oBACAZ;;oBAEA;oBACAC;sBACAM;sBACAK;wBACAZ;;wBAEA;wBACAC;0BACAC;0BACAC;0BACAyD;wBACA;;wBAEA;wBACA3D;0BACA7B;0BACAsC;4BACAN;8BACAH;gCACAC;gCACAC;8BACA;4BACA;0BACA;wBACA;sBACA;oBACA;kBACA;gBACA;cACA;gBACAH;gBACAC;kBACAC;kBACAC;gBACA;cACA;YACA;UACA;YAAA;YACAH;YACAC;cACAC;cACAC;YACA;UACA;QACA;QACAS;UACAZ;UACAC;YACAC;YACAC;UACA;QACA;QACAU;UACAZ;QACA;MACA;IACA;EACA;EACA;EACA4D;IACAC,aACA,wBACA,8BACA,wBACA;MACA7D;IACA;EACA;EAEA;EACA8D;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC7iCA;AAAA;AAAA;AAAA;AAAi9B,CAAgB,i4BAAG,EAAC,C;;;;;;;;;;;ACAr+B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/mall/shops/detail.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/mall/shops/detail.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./detail.vue?vue&type=template&id=6958ef56&\"\nvar renderjs\nimport script from \"./detail.vue?vue&type=script&lang=js&\"\nexport * from \"./detail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./detail.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/mall/shops/detail.vue\"\nexport default component.exports","export * from \"-!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=template&id=6958ef56&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 =\n    !(_vm.loading && !_vm.shop) && !!_vm.shop\n      ? _vm.__map(5, function (n, __i0__) {\n          var $orig = _vm.__get_orig(n)\n          var g0 = Math.floor(_vm.shop.rating || 5)\n          return {\n            $orig: $orig,\n            g0: g0,\n          }\n        })\n      : null\n  var g1 = !(_vm.loading && !_vm.shop) && !!_vm.shop ? _vm.coupons.length : null\n  var g2 =\n    !(_vm.loading && !_vm.shop) && !!_vm.shop && g1 > 0\n      ? _vm.coupons.length\n      : null\n  var g3 =\n    !(_vm.loading && !_vm.shop) &&\n    !!_vm.shop &&\n    _vm.showCoupons &&\n    !_vm.loadingCoupons\n      ? _vm.coupons.length\n      : null\n  var l1 =\n    !(_vm.loading && !_vm.shop) &&\n    !!_vm.shop &&\n    _vm.showCoupons &&\n    !_vm.loadingCoupons &&\n    !(g3 === 0)\n      ? _vm.__map(_vm.coupons, function (coupon, index) {\n          var $orig = _vm.__get_orig(coupon)\n          var m0 = _vm.isCouponDisabled(coupon)\n          var m1 = _vm.formatCouponValue(coupon)\n          var m2 = _vm.formatCouponTime(coupon)\n          var m3 = _vm.isCouponDisabled(coupon) || coupon.userClaimed\n          var m4 = !coupon.userClaimed\n            ? coupon.type === \"SPEED_KILL\" && !_vm.isCouponDisabled(coupon)\n            : null\n          var m5 =\n            !coupon.userClaimed && !m4 ? _vm.isCouponDisabled(coupon) : null\n          return {\n            $orig: $orig,\n            m0: m0,\n            m1: m1,\n            m2: m2,\n            m3: m3,\n            m4: m4,\n            m5: m5,\n          }\n        })\n      : null\n  var g4 =\n    !(_vm.loading && !_vm.shop) && !!_vm.shop && !_vm.loadingCategories\n      ? _vm.categories.length\n      : null\n  var g5 =\n    !(_vm.loading && !_vm.shop) && !!_vm.shop\n      ? _vm.loadingProducts && _vm.products.length === 0\n      : null\n  var g6 =\n    !(_vm.loading && !_vm.shop) && !!_vm.shop && !g5\n      ? _vm.products.length\n      : null\n  var g7 =\n    !(_vm.loading && !_vm.shop) && !!_vm.shop ? _vm.cartItems.length : null\n  var g8 =\n    !(_vm.loading && !_vm.shop) && !!_vm.shop\n      ? _vm.showCartDetail && _vm.cartItems.length > 0\n      : null\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      _vm.showCoupons = true\n    }\n    _vm.e1 = function ($event) {\n      _vm.showCoupons = false\n    }\n    _vm.e2 = function ($event) {\n      _vm.showCoupons = false\n    }\n    _vm.e3 = function ($event) {\n      _vm.showCartDetail = !_vm.showCartDetail\n    }\n    _vm.e4 = function ($event) {\n      _vm.showCartDetail = false\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0,\n        g1: g1,\n        g2: g2,\n        g3: g3,\n        l1: l1,\n        g4: g4,\n        g5: g5,\n        g6: g6,\n        g7: g7,\n        g8: g8,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- 使用自定义导航栏组件 -->\r\n\t\t<custom-nav-bar title=\"店铺详情\" subtitle=\"店铺商品\" :show-back=\"true\"></custom-nav-bar>\r\n\t\t\r\n\t\t<!-- 添加明显的返回按钮 -->\r\n\t\t<view class=\"back-button\" @click=\"goBack\">\r\n\t\t\t<text class=\"back-arrow\">←</text>\r\n\t\t\t<text class=\"back-text\">返回</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 显示加载中状态 -->\r\n\t\t<view v-if=\"loading && !shop\" class=\"loading-container\">\r\n\t\t\t<view class=\"loading-spinner\"></view>\r\n\t\t\t<text class=\"loading-text\">加载中...</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 显示无数据状态 -->\r\n\t\t<view v-else-if=\"!shop\" class=\"empty-container\">\r\n\t\t\t<text class=\"empty-text\">未找到店铺</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 店铺详情内容 -->\r\n\t\t<block v-else>\r\n\t\t\t<!-- 店铺信息 -->\r\n\t\t\t<view class=\"shop-info-card\">\r\n\t\t\t\t<view class=\"shop-header\">\r\n\t\t\t\t\t<image class=\"shop-logo\" :src=\"shop.avatar || shop.logo || 'https://ykhyyy.oss-cn-beijing.aliyuncs.com/ht.jpg'\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t<view class=\"shop-details\">\r\n\t\t\t\t\t\t<view class=\"shop-name-row\">\r\n\t\t\t\t\t\t\t<text class=\"shop-name\">{{ shop.name }}</text>\r\n\t\t\t\t\t\t\t<view class=\"shop-badges\">\r\n\t\t\t\t\t\t\t\t<text v-if=\"shop.isOfficial\" class=\"shop-badge official\">官方</text>\r\n\t\t\t\t\t\t\t\t<text v-if=\"shop.isNew\" class=\"shop-badge new\">新店</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"shop-rating\">\r\n\t\t\t\t\t\t\t<text class=\"rating-score\">{{ shop.rating || '5.0' }}</text>\r\n\t\t\t\t\t\t\t<view class=\"rating-stars\">\r\n\t\t\t\t\t\t\t\t<text v-for=\"n in 5\" :key=\"n\" class=\"star\" :class=\"{ active: n <= Math.floor(shop.rating || 5) }\">★</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<text class=\"rating-count\">{{ shop.ratingCount || 0 }}条评价</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<text class=\"shop-description\">{{ shop.description || '暂无描述' }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 功能选项卡 -->\r\n\t\t\t<view class=\"shop-tabs\">\r\n\t\t\t\t<view class=\"shop-tab-item\" @click=\"goToShopReviews\">\r\n\t\t\t\t\t<view class=\"tab-icon\">🔍</view>\r\n\t\t\t\t\t<text class=\"tab-text\">探店</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"shop-tab-item\" @click=\"showCoupons = true\">\r\n\t\t\t\t\t<view class=\"tab-icon\">🎟️</view>\r\n\t\t\t\t\t<text class=\"tab-text\">优惠券</text>\r\n\t\t\t\t\t<view v-if=\"coupons.length > 0\" class=\"tab-badge\">{{coupons.length}}</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"shop-tab-item active\">\r\n\t\t\t\t\t<view class=\"tab-icon\">🛍️</view>\r\n\t\t\t\t\t<text class=\"tab-text\">商品</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"shop-tab-item\">\r\n\t\t\t\t\t<view class=\"tab-icon\">🏪</view>\r\n\t\t\t\t\t<text class=\"tab-text\">店铺</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 优惠券弹窗 -->\r\n\t\t\t<view class=\"coupon-popup\" v-if=\"showCoupons\">\r\n\t\t\t\t<view class=\"coupon-popup-mask\" @click=\"showCoupons = false\"></view>\r\n\t\t\t\t<view class=\"coupon-popup-content\">\r\n\t\t\t\t\t<view class=\"coupon-popup-header\">\r\n\t\t\t\t\t\t<text class=\"coupon-popup-title\">店铺优惠券</text>\r\n\t\t\t\t\t\t<text class=\"coupon-popup-close\" @click=\"showCoupons = false\">×</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<scroll-view scroll-y class=\"coupon-list\">\r\n\t\t\t\t\t\t<view v-if=\"loadingCoupons\" class=\"loading-container small\">\r\n\t\t\t\t\t\t\t<view class=\"loading-spinner small\"></view>\r\n\t\t\t\t\t\t\t<text class=\"loading-text\">加载优惠券...</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<view v-else-if=\"coupons.length === 0\" class=\"empty-container small\">\r\n\t\t\t\t\t\t\t<text class=\"empty-text\">暂无优惠券</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<view v-else class=\"coupon-items\">\r\n\t\t\t\t\t\t\t<view \r\n\t\t\t\t\t\t\t\tv-for=\"(coupon, index) in coupons\" \r\n\t\t\t\t\t\t\t\t:key=\"coupon.id || index\" \r\n\t\t\t\t\t\t\t\tclass=\"coupon-item\"\r\n\t\t\t\t\t\t\t\t:class=\"{'coupon-speedkill': coupon.type === 'SPEED_KILL', 'coupon-disabled': isCouponDisabled(coupon)}\">\r\n\t\t\t\t\t\t\t\t<view class=\"coupon-left\">\r\n\t\t\t\t\t\t\t\t\t<view class=\"coupon-value\">\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"coupon-currency\" v-if=\"coupon.type !== 'DISCOUNT'\">¥</text>\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"coupon-amount\">{{formatCouponValue(coupon)}}</text>\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"coupon-unit\" v-if=\"coupon.type === 'DISCOUNT'\">折</text>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t<text class=\"coupon-condition\" v-if=\"coupon.minAmount && coupon.minAmount > 0\">满{{coupon.minAmount}}元可用</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<view class=\"coupon-middle\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"coupon-name\">{{coupon.name || '店铺优惠券'}}</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"coupon-desc\">{{coupon.description || '购物可用'}}</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"coupon-time\">{{formatCouponTime(coupon)}}</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"coupon-tag\" v-if=\"coupon.type === 'SPEED_KILL'\">秒杀</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"coupon-tag\" v-else-if=\"coupon.type === 'DISCOUNT'\">折扣券</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"coupon-tag\" v-else>满减券</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<view class=\"coupon-right\">\r\n\t\t\t\t\t\t\t\t\t<button \r\n\t\t\t\t\t\t\t\t\t\tclass=\"coupon-btn\" \r\n\t\t\t\t\t\t\t\t\t\t:disabled=\"isCouponDisabled(coupon) || coupon.userClaimed\"\r\n\t\t\t\t\t\t\t\t\t\t@click=\"claimCoupon(coupon)\">\r\n\t\t\t\t\t\t\t\t\t\t<text v-if=\"coupon.userClaimed\">已领取</text>\r\n\t\t\t\t\t\t\t\t\t\t<text v-else-if=\"coupon.type === 'SPEED_KILL' && !isCouponDisabled(coupon)\">立即抢</text>\r\n\t\t\t\t\t\t\t\t\t\t<text v-else-if=\"isCouponDisabled(coupon)\">已结束</text>\r\n\t\t\t\t\t\t\t\t\t\t<text v-else>立即领</text>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t<text class=\"coupon-limit\" v-if=\"coupon.totalCount && coupon.totalCount > 0\">剩余: {{coupon.totalCount - (coupon.usedCount || 0)}}</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</scroll-view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 商品搜索 -->\r\n\t\t\t<view class=\"search-box\">\r\n\t\t\t\t<view class=\"search-input-wrapper\">\r\n\t\t\t\t\t<image src=\"https://ykhyyy.oss-cn-beijing.aliyuncs.com/ht.jpg\" class=\"search-icon\"></image>\r\n\t\t\t\t\t<input class=\"search-input\" type=\"text\" v-model=\"searchText\" placeholder=\"搜索店内商品\" @confirm=\"searchProducts\" />\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 左右布局区域 -->\r\n\t\t\t<view class=\"content-layout\">\r\n\t\t\t\t<!-- 左侧分类列表 -->\r\n\t\t\t\t<scroll-view scroll-y class=\"category-sidebar\">\r\n\t\t\t\t\t<view v-if=\"loadingCategories\" class=\"loading-container small\">\r\n\t\t\t\t\t\t<view class=\"loading-spinner small\"></view>\r\n\t\t\t\t\t\t<text class=\"loading-text\">加载分类...</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view v-else-if=\"categories.length === 0\" class=\"empty-container small\">\r\n\t\t\t\t\t\t<text class=\"empty-text\">暂无分类</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view v-else class=\"category-list\">\r\n\t\t\t\t\t\t<view \r\n\t\t\t\t\t\t\tv-for=\"(category, index) in categories\" \r\n\t\t\t\t\t\t\t:key=\"category.id || index\" \r\n\t\t\t\t\t\t\tclass=\"category-item\" \r\n\t\t\t\t\t\t\t:class=\"{ active: selectedCategoryId === category.id }\"\r\n\t\t\t\t\t\t\t@click=\"selectCategory(category.id)\">\r\n\t\t\t\t\t\t\t<text class=\"category-name\">{{ category.name }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t\t\r\n\t\t\t\t<!-- 右侧商品展示区 -->\r\n\t\t\t\t<scroll-view scroll-y class=\"product-area\" @scrolltolower=\"loadMore\">\r\n\t\t\t\t\t<!-- 商品列表 -->\r\n\t\t\t\t\t<view v-if=\"loadingProducts && products.length === 0\" class=\"loading-container\">\r\n\t\t\t\t\t\t<view class=\"loading-spinner\"></view>\r\n\t\t\t\t\t\t<text class=\"loading-text\">加载商品中...</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view v-else-if=\"products.length === 0\" class=\"empty-container\">\r\n\t\t\t\t\t\t<text class=\"empty-text\">暂无商品</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view v-else class=\"products-grid\">\r\n\t\t\t\t\t\t<view \r\n\t\t\t\t\t\t\tclass=\"product-card\" \r\n\t\t\t\t\t\t\tv-for=\"(product, index) in products\" \r\n\t\t\t\t\t\t\t:key=\"product.id || index\" \r\n\t\t\t\t\t\t\t@click=\"viewProductDetail(product.id)\">\r\n\t\t\t\t\t\t\t<image \r\n\t\t\t\t\t\t\t\tclass=\"product-image\" \r\n\t\t\t\t\t\t\t\t:src=\"product.image || 'https://ykhyyy.oss-cn-beijing.aliyuncs.com/ht.jpg'\" \r\n\t\t\t\t\t\t\t\tmode=\"aspectFill\"></image>\r\n\t\t\t\t\t\t\t<view class=\"product-info\">\r\n\t\t\t\t\t\t\t\t<text class=\"product-name\">{{ product.name }}</text>\r\n\t\t\t\t\t\t\t\t<view class=\"product-price-row\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"product-price\">¥{{ product.price || '0.00' }}</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"product-sold\">已售{{ product.sales || 0 }}件</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<!-- 添加商品按钮 -->\r\n\t\t\t\t\t\t\t<view @click.stop class=\"add-to-cart-wrapper\">\r\n\t\t\t\t\t\t\t\t<view class=\"add-to-cart\" @click.stop=\"addToCart(index)\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"add-icon\">+</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- 加载更多 -->\r\n\t\t\t\t\t<view v-if=\"hasMore\" class=\"load-more\" @click=\"loadMore\">\r\n\t\t\t\t\t\t<text v-if=\"!loadingMore\">加载更多</text>\r\n\t\t\t\t\t\t<view v-else class=\"loading-spinner small\"></view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view v-else class=\"no-more\">\r\n\t\t\t\t\t\t<text>没有更多商品了</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 购物车底部栏 -->\r\n\t\t\t<view class=\"cart-bar\" v-if=\"cartItems.length > 0\">\r\n\t\t\t\t<view class=\"cart-info\">\r\n\t\t\t\t\t<view class=\"cart-icon-wrapper\" @click=\"showCartDetail = !showCartDetail\">\r\n\t\t\t\t\t\t<view class=\"cart-icon\">🛒</view>\r\n\t\t\t\t\t\t<view class=\"cart-count\">{{getTotalCount}}</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"cart-total\">\r\n\t\t\t\t\t\t<text class=\"total-label\">合计:</text>\r\n\t\t\t\t\t\t<text class=\"total-price\">¥{{getTotalPrice}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<button class=\"checkout-btn\" @click=\"checkout\">去结算</button>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 购物车详情弹窗 -->\r\n\t\t\t<view class=\"cart-detail-popup\" v-if=\"showCartDetail && cartItems.length > 0\">\r\n\t\t\t\t<view class=\"cart-detail-content\">\r\n\t\t\t\t\t<view class=\"cart-detail-header\">\r\n\t\t\t\t\t\t<text class=\"cart-detail-title\">购物车</text>\r\n\t\t\t\t\t\t<text class=\"cart-detail-clear\" @click=\"clearCart\">清空</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<scroll-view scroll-y class=\"cart-detail-list\">\r\n\t\t\t\t\t\t<view class=\"cart-item\" v-for=\"(item, index) in cartItems\" :key=\"index\">\r\n\t\t\t\t\t\t\t<image class=\"cart-item-image\" :src=\"item.image || 'https://ykhyyy.oss-cn-beijing.aliyuncs.com/ht.jpg'\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t\t\t<view class=\"cart-item-info\">\r\n\t\t\t\t\t\t\t\t<text class=\"cart-item-name\">{{item.name}}</text>\r\n\t\t\t\t\t\t\t\t<text class=\"cart-item-price\">¥{{item.price}}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"cart-item-controls\">\r\n\t\t\t\t\t\t\t\t<view class=\"quantity-btn minus\" @click=\"decreaseQuantity(index)\">-</view>\r\n\t\t\t\t\t\t\t\t<text class=\"quantity-text\">{{item.quantity}}</text>\r\n\t\t\t\t\t\t\t\t<view class=\"quantity-btn plus\" @click=\"increaseQuantity(index)\">+</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</scroll-view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"cart-detail-mask\" @click=\"showCartDetail = false\"></view>\r\n\t\t\t</view>\r\n\t\t</block>\r\n\t\t\r\n\t\t<!-- AI助手组件 -->\r\n\t\t<ai-assistant></ai-assistant>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport AiAssistant from '@/components/AiAssistant.vue';\r\n\timport CustomNavBar from '@/components/CustomNavBar.vue';\r\n\timport config from '@/config/index.js';\r\n\t\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tAiAssistant,\r\n\t\t\tCustomNavBar\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tid: null,\r\n\t\t\t\tloading: false,\r\n\t\t\t\tloadingProducts: false,\r\n\t\t\t\tloadingCategories: false,\r\n\t\t\t\tloadingMore: false,\r\n\t\t\t\tloadingCoupons: false,\r\n\t\t\t\tshop: null,\r\n\t\t\t\tproducts: [],\r\n\t\t\t\tsearchText: '',\r\n\t\t\t\tselectedCategoryId: null,\r\n\t\t\t\tcurrentPage: 1,\r\n\t\t\t\tpageSize: 10,\r\n\t\t\t\ttotalItems: 0,\r\n\t\t\t\tcategories: [],\r\n\t\t\t\tcoupons: [],\r\n\t\t\t\tshowCoupons: false,\r\n\t\t\t\tuserId: 1, // 当前用户ID，实际应该从全局状态或本地存储获取\r\n\t\t\t\tcartItems: [], // 购物车商品\r\n\t\t\t\tshowCartDetail: false, // 显示购物车详情\r\n\t\t\t\t_preventNavigation: false // 防止导航\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\thasMore() {\r\n\t\t\t\treturn this.products.length < this.totalItems;\r\n\t\t\t},\r\n\t\t\t// 计算购物车总价\r\n\t\t\tgetTotalPrice() {\r\n\t\t\t\tlet total = 0;\r\n\t\t\t\tthis.cartItems.forEach(item => {\r\n\t\t\t\t\ttotal += item.price * item.quantity;\r\n\t\t\t\t});\r\n\t\t\t\treturn total.toFixed(2);\r\n\t\t\t},\r\n\t\t\t// 计算购物车商品总数\r\n\t\t\tgetTotalCount() {\r\n\t\t\t\tlet count = 0;\r\n\t\t\t\tthis.cartItems.forEach(item => {\r\n\t\t\t\t\tcount += item.quantity;\r\n\t\t\t\t});\r\n\t\t\t\treturn count;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\tconsole.log('店铺详情页参数:', JSON.stringify(options));\r\n\t\t\tthis.id = options.id;\r\n\t\t\t\r\n\t\t\tif (!this.id) {\r\n\t\t\t\tconsole.error('未获取到店铺ID');\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '店铺ID无效',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.goBack();\r\n\t\t\t\t}, 1500);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconsole.log('加载店铺ID:', this.id);\r\n\t\t\tthis.loadShopDetails();\r\n\t\t\tthis.loadProductCategories();\r\n\t\t\tthis.loadProducts(true);\r\n\t\t\tthis.loadShopCoupons();\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 加载店铺详情\r\n\t\t\tloadShopDetails() {\r\n\t\t\t\tthis.loading = true;\r\n\t\t\t\tconsole.log('请求店铺详情API:', `${config.BaseUrl}/api/shop/${this.id}`);\r\n\t\t\t\t\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: `${config.BaseUrl}/api/shop/${this.id}`,\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'content-type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('获取店铺详情成功:', JSON.stringify(res.data));\r\n\t\t\t\t\t\tif (res.data && res.data.code === 1) {\r\n\t\t\t\t\t\t\tconst shopData = res.data.data;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconsole.log('处理前的店铺数据:', JSON.stringify(shopData));\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// 添加isNew和isOfficial标识\r\n\t\t\t\t\t\t\tif (shopData) {\r\n\t\t\t\t\t\t\t\t// 如果创建时间在30天内，标记为新店\r\n\t\t\t\t\t\t\t\tif (shopData.createdTime) {\r\n\t\t\t\t\t\t\t\t\tconst createDate = new Date(shopData.createdTime);\r\n\t\t\t\t\t\t\t\t\tconst now = new Date();\r\n\t\t\t\t\t\t\t\t\tconst diffTime = Math.abs(now - createDate);\r\n\t\t\t\t\t\t\t\t\tconst diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n\t\t\t\t\t\t\t\t\tshopData.isNew = diffDays <= 30;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// 设置默认评分为5.0\r\n\t\t\t\t\t\t\t\tif (!shopData.rating) {\r\n\t\t\t\t\t\t\t\t\tshopData.rating = 5.0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// 根据店铺类型标记是否为官方店铺\r\n\t\t\t\t\t\t\t\tshopData.isOfficial = shopData.type === 'official';\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconsole.log('处理后的店铺数据:', JSON.stringify(shopData));\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconsole.error('返回的店铺数据为空');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.shop = shopData;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.error('获取店铺详情API返回错误:', JSON.stringify(res.data));\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '获取店铺详情失败',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('店铺详情请求失败:', JSON.stringify(err));\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '网络请求失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 加载商品分类\r\n\t\t\tloadProductCategories() {\r\n\t\t\t\tthis.loadingCategories = true;\r\n\t\t\t\t\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: `${config.BaseUrl}/api/shop/product/category/shop/${this.id}`,\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'content-type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('获取商品分类成功:', JSON.stringify(res.data));\r\n\t\t\t\t\t\tif (res.data && res.data.code === 1) {\r\n\t\t\t\t\t\t\tconst categoriesData = res.data.data || [];\r\n\t\t\t\t\t\t\t// 添加全部分类选项\r\n\t\t\t\t\t\t\tconst allCategory = { id: null, name: '全部商品' };\r\n\t\t\t\t\t\t\tthis.categories = [allCategory, ...categoriesData];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.error('获取商品分类API返回错误:', JSON.stringify(res.data));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('获取商品分类请求失败:', JSON.stringify(err));\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tthis.loadingCategories = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 加载商品\r\n\t\t\tloadProducts(refresh = true) {\r\n\t\t\t\tif (refresh) {\r\n\t\t\t\t\tthis.currentPage = 1;\r\n\t\t\t\t\tthis.loadingProducts = true;\r\n\t\t\t\t\tthis.products = [];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.loadingMore = true;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 构建查询参数\r\n\t\t\t\tconst params = {\r\n\t\t\t\t\tshopId: this.id,\r\n\t\t\t\t\tcurrent: this.currentPage,\r\n\t\t\t\t\tsize: this.pageSize\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\t// 如果有分类筛选\r\n\t\t\t\tif (this.selectedCategoryId) {\r\n\t\t\t\t\tparams.categoryId = this.selectedCategoryId;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 如果有搜索关键词\r\n\t\t\t\tif (this.searchText) {\r\n\t\t\t\t\tparams.keyword = this.searchText;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('请求商品列表参数:', params);\r\n\t\t\t\t\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: `${config.BaseUrl}/api/shop/product/page`,\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\tdata: params,\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'content-type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('获取商品成功:', JSON.stringify(res.data));\r\n\t\t\t\t\t\tif (res.data && res.data.code === 1) {\r\n\t\t\t\t\t\t\tconst data = res.data.data;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (refresh) {\r\n\t\t\t\t\t\t\t\tthis.products = data.records || [];\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.products = [...this.products, ...(data.records || [])];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.totalItems = data.total;\r\n\t\t\t\t\t\t\tthis.currentPage = data.current;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconsole.log(`已加载${this.products.length}个商品，总共${this.totalItems}个`);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.error('获取商品API返回错误:', JSON.stringify(res.data));\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '获取商品失败',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('请求失败:', JSON.stringify(err));\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '网络请求失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tthis.loadingProducts = false;\r\n\t\t\t\t\t\tthis.loadingMore = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 选择分类\r\n\t\t\tselectCategory(categoryId) {\r\n\t\t\t\tthis.selectedCategoryId = categoryId;\r\n\t\t\t\tthis.searchText = '';\r\n\t\t\t\tthis.loadProducts(true);\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 搜索商品\r\n\t\t\tsearchProducts() {\r\n\t\t\t\tthis.loadProducts(true);\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 加载更多\r\n\t\t\tloadMore() {\r\n\t\t\t\tif (!this.loadingMore && this.hasMore) {\r\n\t\t\t\t\tthis.currentPage++;\r\n\t\t\t\t\tthis.loadProducts(false);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 查看商品详情\r\n\t\t\tviewProductDetail(id) {\r\n\t\t\t\t// 确保不是从添加购物车按钮触发的\r\n\t\t\t\tif (this._preventNavigation) {\r\n\t\t\t\t\tconsole.log('阻止商品详情页导航');\r\n\t\t\t\t\tthis._preventNavigation = false;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (!id) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '商品ID无效',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: `/pages/mall/goods-detail?id=${id}`\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 跳转到店铺探店页面\r\n\t\t\tgoToShopReviews() {\r\n\t\t\t\tif (!this.id) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '店铺ID无效',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('跳转到店铺探店页面，店铺ID:', this.id);\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: `/pages/mall/shops/reviews?id=${this.id}&name=${encodeURIComponent(this.shop.name || '未命名店铺')}`,\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('导航失败:', err);\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '跳转失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tgoBack() {\r\n\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\tdelta: 1,\r\n\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\t// If there's no page to go back to, navigate to mall index\r\n\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\turl: '/pages/mall/index'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 加载店铺优惠券\r\n\t\t\tloadShopCoupons() {\r\n\t\t\t\tthis.loadingCoupons = true;\r\n\t\t\t\t\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: `${config.BaseUrl}/api/coupon/page`,\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tshopId: this.id,\r\n\t\t\t\t\t\tcurrent: 1,\r\n\t\t\t\t\t\tsize: 50\r\n\t\t\t\t\t},\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'content-type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('获取店铺优惠券成功:', JSON.stringify(res.data));\r\n\t\t\t\t\t\tif (res.data && res.data.code === 1) {\r\n\t\t\t\t\t\t\tconst couponsData = res.data.data.records || [];\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// 检查用户是否已领取此优惠券\r\n\t\t\t\t\t\t\tthis.checkUserCoupons(couponsData);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.coupons = couponsData;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.error('获取店铺优惠券API返回错误:', JSON.stringify(res.data));\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '获取店铺优惠券失败',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('获取店铺优惠券请求失败:', JSON.stringify(err));\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '网络请求失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tthis.loadingCoupons = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 检查用户是否已领取优惠券\r\n\t\t\tcheckUserCoupons(coupons) {\r\n\t\t\t\t// 这里应调用后端接口检查用户已领取的优惠券\r\n\t\t\t\t// 实际项目中应该有相应的API\r\n\t\t\t\t// 这里简单模拟一下，随机标记一些优惠券为已领取\r\n\t\t\t\treturn coupons.map(coupon => {\r\n\t\t\t\t\t// 确保每个优惠券对象有必要的属性\r\n\t\t\t\t\tcoupon.userClaimed = Math.random() > 0.7;\r\n\t\t\t\t\tcoupon.value = coupon.value || 0;\r\n\t\t\t\t\tcoupon.discountValue = coupon.discountValue || 0;\r\n\t\t\t\t\tcoupon.minAmount = coupon.minAmount || 0;\r\n\t\t\t\t\tcoupon.totalCount = coupon.totalCount || 0;\r\n\t\t\t\t\tcoupon.usedCount = coupon.usedCount || 0;\r\n\t\t\t\t\treturn coupon;\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 领取优惠券\r\n\t\t\tclaimCoupon(coupon) {\r\n\t\t\t\tif (coupon.userClaimed || this.isCouponDisabled(coupon)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 显示确认对话框\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '领取优惠券',\r\n\t\t\t\t\tcontent: `确定要领取\"${coupon.name || '店铺优惠券'}\"吗？`,\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t// 根据优惠券类型调用不同API\r\n\t\t\t\t\t\t\tif (coupon.type === 'SPEED_KILL') {\r\n\t\t\t\t\t\t\t\tthis.speedKillCoupon(coupon);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.normalClaimCoupon(coupon);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 普通领取优惠券\r\n\t\t\tnormalClaimCoupon(coupon) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '领取中...'\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// 这里应调用相应的领取优惠券API\r\n\t\t\t\t// 模拟请求成功\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 标记为已领取\r\n\t\t\t\t\tconst index = this.coupons.findIndex(c => c.id === coupon.id);\r\n\t\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\t\tthis.$set(this.coupons[index], 'userClaimed', true);\r\n\t\t\t\t\t\t// 减少可用数量\r\n\t\t\t\t\t\tif (this.coupons[index].totalCount > 0) {\r\n\t\t\t\t\t\t\tthis.$set(this.coupons[index], 'usedCount', (this.coupons[index].usedCount || 0) + 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '领取成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t});\r\n\t\t\t\t}, 1000);\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 秒杀优惠券\r\n\t\t\tspeedKillCoupon(coupon) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '抢购中...'\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// 调用秒杀API\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: `${config.BaseUrl}/api/coupon/speedKill`,\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tuserId: this.userId,\r\n\t\t\t\t\t\tcouponId: coupon.id\r\n\t\t\t\t\t},\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'content-type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('秒杀优惠券结果:', JSON.stringify(res.data));\r\n\t\t\t\t\t\tif (res.data && res.data.code === 1) {\r\n\t\t\t\t\t\t\t// 标记为已领取\r\n\t\t\t\t\t\t\tconst index = this.coupons.findIndex(c => c.id === coupon.id);\r\n\t\t\t\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\t\t\t\tthis.$set(this.coupons[index], 'userClaimed', true);\r\n\t\t\t\t\t\t\t\t// 减少可用数量\r\n\t\t\t\t\t\t\t\tif (this.coupons[index].totalCount > 0) {\r\n\t\t\t\t\t\t\t\t\tthis.$set(this.coupons[index], 'usedCount', (this.coupons[index].usedCount || 0) + 1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '抢购成功',\r\n\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: res.data.msg || '抢购失败',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('秒杀请求失败:', JSON.stringify(err));\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '网络请求失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 格式化优惠券值\r\n\t\t\tformatCouponValue(coupon) {\r\n\t\t\t\tif (!coupon) return '0';\r\n\t\t\t\t\r\n\t\t\t\tif (coupon.type === 'DISCOUNT') {\r\n\t\t\t\t\t// 折扣券，显示折扣值\r\n\t\t\t\t\treturn coupon.discountValue ? (coupon.discountValue * 10).toFixed(1) : '0.0';\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 满减券和其他类型，显示减免金额\r\n\t\t\t\t\treturn coupon.value ? coupon.value.toFixed(0) : '0';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 格式化优惠券有效期\r\n\t\t\tformatCouponTime(coupon) {\r\n\t\t\t\tif (!coupon) return '';\r\n\t\t\t\t\r\n\t\t\t\tconst startTime = coupon.startTime ? new Date(coupon.startTime) : new Date();\r\n\t\t\t\tconst endTime = coupon.endTime ? new Date(coupon.endTime) : null;\r\n\t\t\t\t\r\n\t\t\t\tif (!endTime) return '长期有效';\r\n\t\t\t\t\r\n\t\t\t\tconst formatDate = (date) => {\r\n\t\t\t\t\tconst year = date.getFullYear();\r\n\t\t\t\t\tconst month = (date.getMonth() + 1).toString().padStart(2, '0');\r\n\t\t\t\t\tconst day = date.getDate().toString().padStart(2, '0');\r\n\t\t\t\t\treturn `${year}-${month}-${day}`;\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\treturn `${formatDate(startTime)} 至 ${formatDate(endTime)}`;\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 判断优惠券是否已过期或未开始\r\n\t\t\tisCouponDisabled(coupon) {\r\n\t\t\t\tif (!coupon) return true;\r\n\t\t\t\t\r\n\t\t\t\tconst now = new Date();\r\n\t\t\t\tconst startTime = coupon.startTime ? new Date(coupon.startTime) : null;\r\n\t\t\t\tconst endTime = coupon.endTime ? new Date(coupon.endTime) : null;\r\n\t\t\t\t\r\n\t\t\t\t// 如果已经用完\r\n\t\t\t\tif (coupon.totalCount && coupon.totalCount > 0 && (coupon.usedCount || 0) >= coupon.totalCount) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 检查时间\r\n\t\t\t\tif (startTime && now < startTime) {\r\n\t\t\t\t\treturn true; // 未开始\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (endTime && now > endTime) {\r\n\t\t\t\t\treturn true; // 已过期\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 添加商品到购物车\r\n\t\t\taddToCart(index) {\r\n\t\t\t\t// 设置标志防止导航\r\n\t\t\t\tthis._preventNavigation = true;\r\n\t\t\t\t\r\n\t\t\t\t// 确保index有效\r\n\t\t\t\tif (typeof index !== 'number' || index < 0 || index >= this.products.length) {\r\n\t\t\t\t\tconsole.error('添加购物车错误: 商品索引无效', index);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '添加失败，商品索引无效',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 获取产品对象\r\n\t\t\t\tconst product = this.products[index];\r\n\t\t\t\t\r\n\t\t\t\t// 确保product对象存在\r\n\t\t\t\tif (!product || typeof product !== 'object') {\r\n\t\t\t\t\tconsole.error('添加购物车错误: 产品对象无效', product);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '添加失败，商品信息不完整',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 检查商品ID是否存在\r\n\t\t\t\tif (!product.id) {\r\n\t\t\t\t\tconsole.error('添加购物车错误: 产品ID无效', product);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '添加失败，商品ID无效',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('添加商品到购物车:', product.id, product.name);\r\n\t\t\t\t\r\n\t\t\t\t// 检查商品是否已在购物车中\r\n\t\t\t\tconst existingItemIndex = this.cartItems.findIndex(item => item.id === product.id);\r\n\t\t\t\t\r\n\t\t\t\tif (existingItemIndex !== -1) {\r\n\t\t\t\t\t// 如果商品已存在，增加数量\r\n\t\t\t\t\tthis.cartItems[existingItemIndex].quantity += 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 如果商品不存在，添加到购物车\r\n\t\t\t\t\tthis.cartItems.push({\r\n\t\t\t\t\t\tid: product.id,\r\n\t\t\t\t\t\tname: product.name || '未命名商品',\r\n\t\t\t\t\t\tprice: product.price || 0,\r\n\t\t\t\t\t\timage: product.image || 'https://ykhyyy.oss-cn-beijing.aliyuncs.com/ht.jpg',\r\n\t\t\t\t\t\tquantity: 1\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 显示提示\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '已添加到购物车',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// 防止事件冒泡到父元素\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 增加商品数量\r\n\t\t\tincreaseQuantity(index) {\r\n\t\t\t\tthis.cartItems[index].quantity += 1;\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 减少商品数量\r\n\t\t\tdecreaseQuantity(index) {\r\n\t\t\t\tif (this.cartItems[index].quantity > 1) {\r\n\t\t\t\t\tthis.cartItems[index].quantity -= 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 如果数量为1，询问是否移除\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\tcontent: '是否从购物车中移除该商品？',\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\tthis.cartItems.splice(index, 1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 清空购物车\r\n\t\t\tclearCart() {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\tcontent: '确定要清空购物车吗？',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\tthis.cartItems = [];\r\n\t\t\t\t\t\t\tthis.showCartDetail = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 结算\r\n\t\t\tcheckout() {\r\n\t\t\t\tif (this.cartItems.length === 0) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '购物车为空',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 计算订单总金额\r\n\t\t\t\tconst totalAmount = parseFloat(this.getTotalPrice);\r\n\t\t\t\t\r\n\t\t\t\t// 当前时间\r\n\t\t\t\tconst currentTime = new Date().toISOString();\r\n\t\t\t\t\r\n\t\t\t\t// 构建符合后端API期望的订单格式\r\n\t\t\t\tconst orderData = {\r\n\t\t\t\t\torder: {\r\n\t\t\t\t\t\tid: null,           // 显式设置ID为null，让后端生成\r\n\t\t\t\t\t\tuserId: this.userId || 1,\r\n\t\t\t\t\t\tshopId: this.id || 1,\r\n\t\t\t\t\t\tcouponId: null,     // null表示不使用优惠券\r\n\t\t\t\t\t\ttotalAmount: totalAmount || 0,\r\n\t\t\t\t\t\tpayAmount: totalAmount || 0,\r\n\t\t\t\t\t\tstatus: 1,          // 1表示待支付\r\n\t\t\t\t\t\tcreateTime: currentTime,\r\n\t\t\t\t\t\tpayTime: null,      // 支付时间为空\r\n\t\t\t\t\t\tcancelTime: null    // 取消时间为空\r\n\t\t\t\t\t},\r\n\t\t\t\t\torderItems: this.cartItems.map(item => ({\r\n\t\t\t\t\t\tid: null,           // 显式设置ID为null，让后端生成\r\n\t\t\t\t\t\torderId: null,      // 订单ID为空，由后端关联\r\n\t\t\t\t\t\tshopId: this.id || 1,\r\n\t\t\t\t\t\tproductId: item.id,\r\n\t\t\t\t\t\tproductName: item.name || \"未命名商品\",\r\n\t\t\t\t\t\tquantity: item.quantity || 1,\r\n\t\t\t\t\t\tprice: parseFloat(item.price) || 0,\r\n\t\t\t\t\t\ttotalPrice: parseFloat((item.price * item.quantity).toFixed(2)) || 0\r\n\t\t\t\t\t}))\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('提交订单:', JSON.stringify(orderData));\r\n\t\t\t\t\r\n\t\t\t\t// 显示加载中\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '提交订单中...'\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// 调用订单创建API\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: `${config.BaseUrl}/api/shop/order/create`,\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\tdata: orderData,\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'content-type': 'application/json',\r\n\t\t\t\t\t\t...config.getAuthHeader()\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('创建订单结果:', JSON.stringify(res.data));\r\n\t\t\t\t\t\tif (res.data && res.data.code === 1) {\r\n\t\t\t\t\t\t\tconst orderResult = res.data.data;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// 清空购物车\r\n\t\t\t\t\t\t\tthis.cartItems = [];\r\n\t\t\t\t\t\t\tthis.showCartDetail = false;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// 提示成功\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '订单创建成功',\r\n\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// 跳转到订单详情页面\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tconst orderId = orderResult && (orderResult.id || orderResult.orderId);\r\n\t\t\t\t\t\t\t\tif (orderId) {\r\n\t\t\t\t\t\t\t\t\tconsole.log('正在跳转到订单详情页面, orderId:', orderId);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// 尝试使用新路径导航\r\n\t\t\t\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\t\t\t\turl: `/pages/order/detail?id=${orderId}`,\r\n\t\t\t\t\t\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('成功导航到订单详情页面');\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.error('导航到订单详情页面失败:', err);\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t// 尝试备用路径\r\n\t\t\t\t\t\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\t\t\t\t\t\turl: `/pages/mall/order/detail?id=${orderId}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\tfail: (backupErr) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.error('导航到备用订单详情页面也失败:', backupErr);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// 如果都失败了，至少显示成功提示\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: '订单创建成功',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// 将订单ID复制到剪贴板\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.setClipboardData({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata: orderId.toString(),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: '订单号已复制',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}, 2000);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tconsole.error('未返回订单ID:', orderResult);\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '订单创建成功，但无法查看详情',\r\n\t\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, 1500);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.error('订单创建失败:', res.data);\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: res.data?.msg || '创建订单失败',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('创建订单请求失败:', JSON.stringify(err));\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '网络请求失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 下拉刷新\r\n\t\tonPullDownRefresh() {\r\n\t\t\tPromise.all([\r\n\t\t\t\tthis.loadShopDetails(),\r\n\t\t\t\tthis.loadProductCategories(),\r\n\t\t\t\tthis.loadProducts(true)\r\n\t\t\t]).finally(() => {\r\n\t\t\t\tuni.stopPullDownRefresh();\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\t// 上拉加载更多\r\n\t\tonReachBottom() {\r\n\t\t\tthis.loadMore();\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.container {\r\n\t\tbackground-color: #F8F7F2;\r\n\t\tmin-height: 100vh;\r\n\t}\r\n\t\r\n\t.back-button {\r\n\t\tposition: fixed;\r\n\t\ttop: calc(var(--status-bar-height) + 50rpx);\r\n\t\tleft: 30rpx;\r\n\t\tz-index: 1000;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground-color: rgba(255, 255, 255, 0.8);\r\n\t\tpadding: 10rpx 20rpx;\r\n\t\tborder-radius: 30rpx;\r\n\t\tbox-shadow: 0 2rpx 6rpx rgba(0, 0, 0, 0.1);\r\n\t\tborder: 1rpx solid #e0c9d1;\r\n\t}\r\n\t\r\n\t.back-arrow {\r\n\t\tfont-size: 40rpx;\r\n\t\tcolor: #8A3324;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\t\r\n\t.back-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t}\r\n\t\r\n\t/* 加载状态 */\r\n\t.loading-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding: 60rpx 0;\r\n\t}\r\n\t\r\n\t.loading-container.small {\r\n\t\tpadding: 30rpx 0;\r\n\t}\r\n\t\r\n\t.loading-spinner {\r\n\t\twidth: 60rpx;\r\n\t\theight: 60rpx;\r\n\t\tborder: 6rpx solid #f3f3f3;\r\n\t\tborder-top: 6rpx solid #7EC4CF;\r\n\t\tborder-radius: 50%;\r\n\t\tanimation: spin 1s linear infinite;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.loading-spinner.small {\r\n\t\twidth: 40rpx;\r\n\t\theight: 40rpx;\r\n\t\tborder-width: 4rpx;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t@keyframes spin {\r\n\t\t0% { transform: rotate(0deg); }\r\n\t\t100% { transform: rotate(360deg); }\r\n\t}\r\n\t\r\n\t.loading-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t.empty-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding: 80rpx 0;\r\n\t}\r\n\t\r\n\t.empty-container.small {\r\n\t\tpadding: 40rpx 0;\r\n\t}\r\n\t\r\n\t.empty-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t/* 店铺信息 */\r\n\t.shop-info-card {\r\n\t\tmargin: 30rpx;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 15rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 8rpx rgba(0,0,0,0.05);\r\n\t\tborder: 1rpx solid #e0c9d1;\r\n\t}\r\n\t\r\n\t.shop-header {\r\n\t\tdisplay: flex;\r\n\t}\r\n\t\r\n\t.shop-logo {\r\n\t\twidth: 120rpx;\r\n\t\theight: 120rpx;\r\n\t\tborder-radius: 15rpx;\r\n\t\tmargin-right: 20rpx;\r\n\t\tborder: 1rpx solid #f0f0f0;\r\n\t}\r\n\t\r\n\t.shop-details {\r\n\t\tflex: 1;\r\n\t}\r\n\t\r\n\t.shop-name-row {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t.shop-name {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-weight: bold;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\t\r\n\t.shop-badges {\r\n\t\tdisplay: flex;\r\n\t}\r\n\t\r\n\t.shop-badge {\r\n\t\tfont-size: 20rpx;\r\n\t\tpadding: 2rpx 8rpx;\r\n\t\tborder-radius: 6rpx;\r\n\t\tmargin-left: 10rpx;\r\n\t}\r\n\t\r\n\t.shop-badge.official {\r\n\t\tbackground-color: rgba(126, 196, 207, 0.1);\r\n\t\tcolor: #7EC4CF;\r\n\t\tborder: 1rpx solid #7EC4CF;\r\n\t}\r\n\t\r\n\t.shop-badge.new {\r\n\t\tbackground-color: rgba(138, 51, 36, 0.1);\r\n\t\tcolor: #8A3324;\r\n\t\tborder: 1rpx solid #8A3324;\r\n\t}\r\n\t\r\n\t.shop-rating {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t.rating-score {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #FF9500;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-right: 6rpx;\r\n\t}\r\n\t\r\n\t.rating-stars {\r\n\t\tdisplay: flex;\r\n\t\tmargin-right: 6rpx;\r\n\t}\r\n\t\r\n\t.star {\r\n\t\tcolor: #DDDDDD;\r\n\t\tfont-size: 24rpx;\r\n\t}\r\n\t\r\n\t.star.active {\r\n\t\tcolor: #FF9500;\r\n\t}\r\n\t\r\n\t.rating-count {\r\n\t\tfont-size: 20rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t.shop-description {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #666;\r\n\t\tline-height: 1.5;\r\n\t\tdisplay: -webkit-box;\r\n\t\t-webkit-box-orient: vertical;\r\n\t\t-webkit-line-clamp: 2;\r\n\t\toverflow: hidden;\r\n\t}\r\n\t\r\n\t/* 搜索框 */\r\n\t.search-box {\r\n\t\tpadding: 0 30rpx 20rpx;\r\n\t}\r\n\t\r\n\t.search-input-wrapper {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 30rpx;\r\n\t\tpadding: 0 20rpx;\r\n\t\tborder: 1rpx solid #e0c9d1;\r\n\t\tbox-shadow: 0 2rpx 6rpx rgba(0,0,0,0.05);\r\n\t}\r\n\t\r\n\t.search-icon {\r\n\t\twidth: 32rpx;\r\n\t\theight: 32rpx;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\t\r\n\t.search-input {\r\n\t\tflex: 1;\r\n\t\tborder: none;\r\n\t\tbackground: transparent;\r\n\t\tfont-size: 28rpx;\r\n\t\tpadding: 16rpx 0;\r\n\t\toutline: none;\r\n\t}\r\n\t\r\n\t/* 左右布局区域 */\r\n\t.content-layout {\r\n\t\tdisplay: flex;\r\n\t\theight: calc(100vh - 480rpx); /* 调整高度以适应新的顶部布局 */\r\n\t\tmargin: 0 30rpx 30rpx;\r\n\t}\r\n\t\r\n\t/* 左侧分类侧边栏 */\r\n\t.category-sidebar {\r\n\t\twidth: 200rpx;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 15rpx 0 0 15rpx;\r\n\t\tbox-shadow: 0 4rpx 8rpx rgba(0,0,0,0.05);\r\n\t\tborder: 1rpx solid #e0c9d1;\r\n\t\tborder-right: none;\r\n\t}\r\n\t\r\n\t.category-list {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t}\r\n\t\r\n\t.category-item {\r\n\t\tpadding: 30rpx 20rpx;\r\n\t\ttext-align: center;\r\n\t\tborder-bottom: 1rpx solid #f0f0f0;\r\n\t}\r\n\t\r\n\t.category-item.active {\r\n\t\tbackground-color: rgba(138, 51, 36, 0.1);\r\n\t\tborder-left: 4rpx solid #8A3324;\r\n\t}\r\n\t\r\n\t.category-name {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #666;\r\n\t\twhite-space: nowrap;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t}\r\n\t\r\n\t.category-item.active .category-name {\r\n\t\tcolor: #8A3324;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\t\r\n\t/* 右侧商品区域 */\r\n\t.product-area {\r\n\t\tflex: 1;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 0 15rpx 15rpx 0;\r\n\t\tbox-shadow: 0 4rpx 8rpx rgba(0,0,0,0.05);\r\n\t\tborder: 1rpx solid #e0c9d1;\r\n\t\tpadding: 20rpx;\r\n\t}\r\n\t\r\n\t/* 商品列表 */\r\n\t.products-grid {\r\n\t\tdisplay: flex;\r\n\t\tflex-wrap: wrap;\r\n\t\tmargin: 0 -10rpx;\r\n\t}\r\n\t\r\n\t.product-card {\r\n\t\twidth: calc(100% - 20rpx);\r\n\t\tmargin: 10rpx;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 10rpx;\r\n\t\toverflow: hidden;\r\n\t\tbox-shadow: 0 2rpx 6rpx rgba(0,0,0,0.05);\r\n\t\tborder: 1rpx solid #f0f0f0;\r\n\t\tposition: relative;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tpadding: 15rpx;\r\n\t\theight: 180rpx;\r\n\t}\r\n\t\r\n\t.product-image {\r\n\t\twidth: 150rpx;\r\n\t\theight: 150rpx;\r\n\t\tborder-radius: 8rpx;\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\t\r\n\t.product-info {\r\n\t\tflex: 1;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 0 15rpx;\r\n\t\toverflow: hidden;\r\n\t}\r\n\t\r\n\t.product-name {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-bottom: 10rpx;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\tdisplay: -webkit-box;\r\n\t\t-webkit-line-clamp: 2;\r\n\t\t-webkit-box-orient: vertical;\r\n\t}\r\n\t\r\n\t.product-price-row {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t}\r\n\t\r\n\t.product-price {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #FF5722;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-bottom: 6rpx;\r\n\t}\r\n\t\r\n\t.product-sold {\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t.load-more, .no-more {\r\n\t\ttext-align: center;\r\n\t\tpadding: 30rpx 0;\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t/* 店铺操作按钮 */\r\n\t.shop-actions {\r\n\t\tdisplay: none;\r\n\t}\r\n\t\r\n\t.explore-btn, .coupon-btn {\r\n\t\tdisplay: none;\r\n\t}\r\n\t\r\n\t/* 店铺操作按钮 - 移除此部分 */\r\n\t.shop-actions {\r\n\t\tdisplay: none;\r\n\t}\r\n\t\r\n\t.explore-btn, .coupon-btn {\r\n\t\tdisplay: none;\r\n\t}\r\n\t\r\n\t/* 店铺信息 */\r\n\t.shop-info-card {\r\n\t\tmargin: 30rpx;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 15rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 8rpx rgba(0,0,0,0.05);\r\n\t\tborder: 1rpx solid #e0c9d1;\r\n\t}\r\n\t\r\n\t/* 功能选项卡 */\r\n\t.shop-tabs {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-around;\r\n\t\tbackground: #fff;\r\n\t\tmargin: 0 30rpx 30rpx;\r\n\t\tpadding: 20rpx 0;\r\n\t\tborder-radius: 15rpx;\r\n\t\tbox-shadow: 0 4rpx 8rpx rgba(0,0,0,0.05);\r\n\t\tborder: 1rpx solid #e0c9d1;\r\n\t}\r\n\t\r\n\t.shop-tab-item {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tposition: relative;\r\n\t\tpadding: 15rpx 0;\r\n\t\tflex: 1;\r\n\t}\r\n\t\r\n\t.shop-tab-item.active {\r\n\t\tcolor: #8A3324;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\t\r\n\t.shop-tab-item.active::after {\r\n\t\tcontent: '';\r\n\t\tposition: absolute;\r\n\t\tbottom: -10rpx;\r\n\t\tleft: 30%;\r\n\t\twidth: 40%;\r\n\t\theight: 6rpx;\r\n\t\tbackground-color: #8A3324;\r\n\t\tborder-radius: 3rpx;\r\n\t}\r\n\t\r\n\t.tab-icon {\r\n\t\tfont-size: 40rpx;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t.tab-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t}\r\n\t\r\n\t.tab-badge {\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tright: 20%;\r\n\t\tbackground-color: #FF5722;\r\n\t\tcolor: white;\r\n\t\tfont-size: 20rpx;\r\n\t\twidth: 32rpx;\r\n\t\theight: 32rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\t\r\n\t/* 优惠券弹窗 */\r\n\t.coupon-popup {\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tz-index: 1000;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\t\r\n\t.coupon-popup-mask {\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\r\n\t}\r\n\t\r\n\t.coupon-popup-content {\r\n\t\tposition: relative;\r\n\t\twidth: 92%;\r\n\t\tmax-height: 85%;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 20rpx;\r\n\t\toverflow: hidden;\r\n\t\tz-index: 1001;\r\n\t\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.1);\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t}\r\n\t\r\n\t.coupon-popup-header {\r\n\t\tpadding: 30rpx;\r\n\t\tbackground: linear-gradient(135deg, #8A3324, #7EC4CF);\r\n\t\tcolor: white;\r\n\t\tborder-bottom: 1rpx solid #f0f0f0;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.coupon-popup-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: white;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t}\r\n\t\r\n\t.coupon-popup-close {\r\n\t\tfont-size: 40rpx;\r\n\t\tcolor: white;\r\n\t\tpadding: 10rpx;\r\n\t}\r\n\t\r\n\t.coupon-list {\r\n\t\tflex: 1;\r\n\t\tmax-height: 800rpx;\r\n\t}\r\n\t\r\n\t.coupon-items {\r\n\t\tpadding: 20rpx;\r\n\t}\r\n\t\r\n\t/* 优惠券样式 */\r\n\t.coupon-item {\r\n\t\tdisplay: flex;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\theight: 200rpx;\r\n\t\tbackground: linear-gradient(90deg, #FFF8F3, #FFF);\r\n\t\tborder-radius: 10rpx;\r\n\t\toverflow: hidden;\r\n\t\tbox-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\r\n\t\tposition: relative;\r\n\t}\r\n\t\r\n\t.coupon-item::before {\r\n\t\tcontent: '';\r\n\t\tposition: absolute;\r\n\t\tleft: 25%;\r\n\t\ttop: -8rpx;\r\n\t\twidth: 16rpx;\r\n\t\theight: 16rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground-color: #F8F7F2;\r\n\t}\r\n\t\r\n\t.coupon-item::after {\r\n\t\tcontent: '';\r\n\t\tposition: absolute;\r\n\t\tleft: 25%;\r\n\t\tbottom: -8rpx;\r\n\t\twidth: 16rpx;\r\n\t\theight: 16rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground-color: #F8F7F2;\r\n\t}\r\n\t\r\n\t.coupon-left {\r\n\t\twidth: 25%;\r\n\t\tbackground-color: #8A3324;\r\n\t\tcolor: #FFF;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tpadding: 0 10rpx;\r\n\t\tposition: relative;\r\n\t}\r\n\t\r\n\t.coupon-left::before {\r\n\t\tcontent: '';\r\n\t\tposition: absolute;\r\n\t\tright: -10rpx;\r\n\t\ttop: 20rpx;\r\n\t\tbottom: 20rpx;\r\n\t\twidth: 1rpx;\r\n\t\tbackground: repeating-linear-gradient(to bottom, #FFF, #FFF 6rpx, transparent 6rpx, transparent 12rpx);\r\n\t}\r\n\t\r\n\t.coupon-value {\r\n\t\tdisplay: flex;\r\n\t\talign-items: baseline;\r\n\t}\r\n\t\r\n\t.coupon-currency {\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\t\r\n\t.coupon-amount {\r\n\t\tfont-size: 50rpx;\r\n\t\tfont-weight: bold;\r\n\t\tline-height: 1;\r\n\t}\r\n\t\r\n\t.coupon-unit {\r\n\t\tfont-size: 24rpx;\r\n\t\tmargin-left: 4rpx;\r\n\t}\r\n\t\r\n\t.coupon-condition {\r\n\t\tfont-size: 20rpx;\r\n\t\tmargin-top: 10rpx;\r\n\t\ttext-align: center;\r\n\t\topacity: 0.8;\r\n\t}\r\n\t\r\n\t.coupon-middle {\r\n\t\tflex: 1;\r\n\t\tpadding: 20rpx;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: center;\r\n\t\tposition: relative;\r\n\t}\r\n\t\r\n\t.coupon-name {\r\n\t\tfont-size: 30rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-bottom: 10rpx;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t}\r\n\t\r\n\t.coupon-desc {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #666;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t.coupon-time {\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t.coupon-tag {\r\n\t\tposition: absolute;\r\n\t\ttop: 20rpx;\r\n\t\tright: 20rpx;\r\n\t\tfont-size: 20rpx;\r\n\t\tcolor: #8A3324;\r\n\t\tborder: 1rpx solid #8A3324;\r\n\t\tpadding: 2rpx 10rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\tbackground-color: rgba(138, 51, 36, 0.05);\r\n\t}\r\n\t\r\n\t.coupon-right {\r\n\t\twidth: 25%;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tpadding: 0 10rpx;\r\n\t}\r\n\t\r\n\t.coupon-btn {\r\n\t\tbackground-color: #8A3324;\r\n\t\tcolor: #FFF;\r\n\t\tfont-size: 24rpx;\r\n\t\twidth: 120rpx;\r\n\t\theight: 60rpx;\r\n\t\tline-height: 60rpx;\r\n\t\ttext-align: center;\r\n\t\tborder-radius: 30rpx;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t.coupon-btn[disabled] {\r\n\t\tbackground-color: #ccc;\r\n\t\tcolor: #fff;\r\n\t}\r\n\t\r\n\t.coupon-limit {\r\n\t\tfont-size: 20rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t/* 秒杀优惠券样式 */\r\n\t.coupon-speedkill .coupon-left {\r\n\t\tbackground-color: #FF5722;\r\n\t}\r\n\t\r\n\t.coupon-speedkill .coupon-tag {\r\n\t\tcolor: #FF5722;\r\n\t\tborder-color: #FF5722;\r\n\t\tbackground-color: rgba(255, 87, 34, 0.05);\r\n\t}\r\n\t\r\n\t.coupon-speedkill .coupon-btn {\r\n\t\tbackground-color: #FF5722;\r\n\t\tanimation: pulse 1.5s infinite;\r\n\t}\r\n\t\r\n\t@keyframes pulse {\r\n\t\t0% {\r\n\t\t\ttransform: scale(1);\r\n\t\t}\r\n\t\t50% {\r\n\t\t\ttransform: scale(1.05);\r\n\t\t}\r\n\t\t100% {\r\n\t\t\ttransform: scale(1);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/* 禁用优惠券样式 */\r\n\t.coupon-disabled {\r\n\t\topacity: 0.6;\r\n\t}\r\n\t\r\n\t.coupon-disabled .coupon-left {\r\n\t\tbackground-color: #999;\r\n\t}\r\n\t\r\n\t/* 添加商品按钮 */\r\n\t.add-to-cart-wrapper {\r\n\t\tposition: absolute;\r\n\t\tright: 15rpx;\r\n\t\tbottom: 15rpx;\r\n\t\tz-index: 10;\r\n\t}\r\n\t\r\n\t.add-to-cart {\r\n\t\twidth: 50rpx;\r\n\t\theight: 50rpx;\r\n\t\tborder-radius: 25rpx;\r\n\t\tbackground-color: #8A3324;\r\n\t\tcolor: #fff;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tbox-shadow: 0 2rpx 6rpx rgba(0,0,0,0.2);\r\n\t}\r\n\t\r\n\t.add-icon {\r\n\t\tfont-size: 30rpx;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\t\r\n\t/* 购物车底部栏 */\r\n\t.cart-bar {\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\tbottom: 0;\r\n\t\twidth: 100%;\r\n\t\theight: 100rpx;\r\n\t\tbackground-color: #fff;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 0 30rpx;\r\n\t\tbox-shadow: 0 -2rpx 10rpx rgba(0,0,0,0.05);\r\n\t\tz-index: 100;\r\n\t}\r\n\t\r\n\t.cart-info {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.cart-icon-wrapper {\r\n\t\tposition: relative;\r\n\t\tmargin-right: 20rpx;\r\n\t}\r\n\t\r\n\t.cart-icon {\r\n\t\tfont-size: 50rpx;\r\n\t}\r\n\t\r\n\t.cart-count {\r\n\t\tposition: absolute;\r\n\t\ttop: -10rpx;\r\n\t\tright: -10rpx;\r\n\t\tbackground-color: #FF5722;\r\n\t\tcolor: white;\r\n\t\tfont-size: 20rpx;\r\n\t\tmin-width: 32rpx;\r\n\t\theight: 32rpx;\r\n\t\tborder-radius: 16rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tpadding: 0 6rpx;\r\n\t}\r\n\t\r\n\t.cart-total {\r\n\t\tdisplay: flex;\r\n\t\talign-items: baseline;\r\n\t}\r\n\t\r\n\t.total-label {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\t\r\n\t.total-price {\r\n\t\tfont-size: 36rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #FF5722;\r\n\t}\r\n\t\r\n\t.checkout-btn {\r\n\t\tbackground-color: #8A3324;\r\n\t\tcolor: white;\r\n\t\tfont-size: 28rpx;\r\n\t\tpadding: 0 40rpx;\r\n\t\theight: 70rpx;\r\n\t\tline-height: 70rpx;\r\n\t\tborder-radius: 35rpx;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t}\r\n\t\r\n\t/* 购物车详情弹窗 */\r\n\t.cart-detail-popup {\r\n\t\tposition: fixed;\r\n\t\tbottom: 100rpx;\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\theight: calc(100% - 100rpx);\r\n\t\tz-index: 99;\r\n\t}\r\n\t\r\n\t.cart-detail-mask {\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\r\n\t}\r\n\t\r\n\t.cart-detail-content {\r\n\t\tposition: absolute;\r\n\t\tbottom: 0;\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\tmax-height: 70%;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 20rpx 20rpx 0 0;\r\n\t\toverflow: hidden;\r\n\t\tz-index: 100;\r\n\t\tbox-shadow: 0 -4rpx 20rpx rgba(0, 0, 0, 0.1);\r\n\t}\r\n\t\r\n\t.cart-detail-header {\r\n\t\tpadding: 30rpx;\r\n\t\tborder-bottom: 1rpx solid #f0f0f0;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.cart-detail-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t}\r\n\t\r\n\t.cart-detail-clear {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #999;\r\n\t\tpadding: 6rpx 16rpx;\r\n\t\tborder: 1rpx solid #eee;\r\n\t\tborder-radius: 30rpx;\r\n\t}\r\n\t\r\n\t.cart-detail-list {\r\n\t\tmax-height: 600rpx;\r\n\t\tpadding: 20rpx;\r\n\t}\r\n\t\r\n\t.cart-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 20rpx;\r\n\t\tborder-bottom: 1rpx solid #f5f5f5;\r\n\t}\r\n\t\r\n\t.cart-item-image {\r\n\t\twidth: 120rpx;\r\n\t\theight: 120rpx;\r\n\t\tborder-radius: 10rpx;\r\n\t\tmargin-right: 20rpx;\r\n\t}\r\n\t\r\n\t.cart-item-info {\r\n\t\tflex: 1;\r\n\t}\r\n\t\r\n\t.cart-item-name {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t\tmargin-bottom: 10rpx;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t}\r\n\t\r\n\t.cart-item-price {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #FF5722;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\t\r\n\t.cart-item-controls {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.quantity-btn {\r\n\t\twidth: 50rpx;\r\n\t\theight: 50rpx;\r\n\t\tborder-radius: 25rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\t\r\n\t.quantity-btn.minus {\r\n\t\tbackground-color: #f5f5f5;\r\n\t\tcolor: #666;\r\n\t}\r\n\t\r\n\t.quantity-btn.plus {\r\n\t\tbackground-color: #8A3324;\r\n\t\tcolor: white;\r\n\t}\r\n\t\r\n\t.quantity-text {\r\n\t\twidth: 60rpx;\r\n\t\ttext-align: center;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n</style> ","import mod from \"-!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1749284202447\n      var cssReload = require(\"C:/App/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}