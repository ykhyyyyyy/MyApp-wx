{"version":3,"sources":["uni-app:///main.js",null,"webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/mall/shops/reviews.vue?9855","webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/mall/shops/reviews.vue?79c8","webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/mall/shops/reviews.vue?2305","uni-app:///pages/mall/shops/reviews.vue","webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/mall/shops/reviews.vue?744a","webpack:///C:/Users/ykh/Desktop/MyApp-wx/pages/mall/shops/reviews.vue?fdd1"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","AiAssistant","CustomNavBar","data","shopId","shopName","loading","loadingMore","currentPage","pageSize","totalItems","reviews","sortType","computed","hasMore","onLoad","console","uni","title","icon","setTimeout","methods","loadReviews","current","size","params","url","method","header","success","review","fail","complete","setSort","loadMore","viewReviewDetail","likeReview","commentReview","shareReview","withShareTicket","createReview","previewImage","urls","formatDate","goBack","delta","onPullDownRefresh","onReachBottom"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,gBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoH;AACpH;AAC2D;AACL;AACa;;;AAGnE;AACgL;AAChL,gBAAgB,iLAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,kFAAM;AACR,EAAE,2FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,sFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACzCA;AAAA;AAAA;AAAA;AAAqqB,CAAgB,qoBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;ACmHzrB;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eAEA;EACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;;EACAC;IACAC;MACA;IACA;EACA;EACAC;IAAA;IACAC;IACA;IACA;IAEA;MACAA;MACAC;QACAC;QACAC;MACA;MACAC;QACA;MACA;MACA;IACA;IAEAJ;IACA;EACA;EACAK;IACA;IACAC;MAAA;MAAA;MACA;QACA;QACA;QACA;MACA;QACA;MACA;;MAEA;MACA;QACAlB;QACAmB;QACAC;MACA;;MAEA;MACA;QACAC;QACAA;MACA;QACAA;QACAA;MACA;QACAA;QACAA;MACA;MAEAT;MAEAC;QACAS;QACAC;QACAxB;QACAyB;UACA;QACA;QACAC;UACAb;UACA;YACA;YAEA;cACA;YACA;cACA;YACA;YAEA;YACA;;YAEA;YACA;cACA;cACA;gBACA;kBACAc;gBACA;kBACAd;kBACAc;gBACA;cACA;gBACAA;cACA;;cAEA;cACAA;YACA;YAEAd;UACA;YACAA;YACAC;cACAC;cACAC;YACA;UACA;QACA;QACAY;UACAf;UACAC;YACAC;YACAC;UACA;QACA;QACAa;UACA;UACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;QACA;QACA;MACA;IACA;IAEA;IACAC;MACA;QACAlB;UACAC;UACAC;QACA;QACA;MACA;MAEAF;QACAS;MACA;IACA;IAEA;IACAU;MACA;MACAN;MAEA;QACAA;MACA;QACAA;MACA;;MAEA;MACA;MAEAb;QACAC;QACAC;MACA;IACA;IAEA;IACAkB;MACApB;QACAS;MACA;IACA;IAEA;IACAY;MACArB;QACAsB;MACA;IACA;IAEA;IACAC;MACAvB;QACAS;MACA;IACA;IAEA;IACAe;MACAxB;QACAyB;QACAnB;MACA;IACA;IAEA;IACAoB;MACA;MAEA;MACA;MACA;;MAEA;MACA;QACA;MACA;;MAEA;MACA;QACA;MACA;;MAEA;MACA;QACA;MACA;;MAEA;MACA;QACA;MACA;;MAEA;MACA;MACA;MACA;MACA;IACA;IAEAC;MAAA;MACA3B;QACA4B;QACAd;UACA;UACAd;YACAS;UACA;QACA;MACA;IACA;EACA;EACA;EACAoB;IACA;IACA1B;MACAH;IACA;EACA;EAEA;EACA8B;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACxYA;AAAA;AAAA;AAAA;AAAk9B,CAAgB,k4BAAG,EAAC,C;;;;;;;;;;;ACAt+B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/mall/shops/reviews.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/mall/shops/reviews.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./reviews.vue?vue&type=template&id=6e0990c7&\"\nvar renderjs\nimport script from \"./reviews.vue?vue&type=script&lang=js&\"\nexport * from \"./reviews.vue?vue&type=script&lang=js&\"\nimport style0 from \"./reviews.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/mall/shops/reviews.vue\"\nexport default component.exports","export * from \"-!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./reviews.vue?vue&type=template&id=6e0990c7&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.loading && _vm.reviews.length === 0\n  var g1 = !g0 ? _vm.reviews.length : null\n  var l1 =\n    !g0 && !(g1 === 0)\n      ? _vm.__map(_vm.reviews, function (review, index) {\n          var $orig = _vm.__get_orig(review)\n          var g2 = Math.floor(review.rating || 0)\n          var m0 = _vm.formatDate(review.createTime)\n          var g3 = review.images && review.images.length > 0\n          var l0 = g3 ? review.images.slice(0, 3) : null\n          var g4 = g3 ? review.images.length : null\n          var g5 = g3 && g4 > 3 ? review.images.length : null\n          return {\n            $orig: $orig,\n            g2: g2,\n            m0: m0,\n            g3: g3,\n            l0: l0,\n            g4: g4,\n            g5: g5,\n          }\n        })\n      : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        l1: l1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./reviews.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./reviews.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- 使用自定义导航栏组件 -->\r\n\t\t<custom-nav-bar :title=\"'探店 - ' + shopName\" subtitle=\"探店评价\" :show-back=\"true\"></custom-nav-bar>\r\n\t\t\r\n\t\t<!-- 添加明显的返回按钮 -->\r\n\t\t<view class=\"back-button\" @click=\"goBack\">\r\n\t\t\t<text class=\"back-arrow\">←</text>\r\n\t\t\t<text class=\"back-text\">返回</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 顶部信息 -->\r\n\t\t<view class=\"header-info\">\r\n\t\t\t<text class=\"header-title\">{{shopName}}的探店内容</text>\r\n\t\t\t<text class=\"header-subtitle\">共{{totalItems}}条探店体验</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 筛选选项 -->\r\n\t\t<view class=\"filter-options\">\r\n\t\t\t<view class=\"filter-item\" :class=\"{ active: sortType === 'latest' }\" @click=\"setSort('latest')\">\r\n\t\t\t\t<text class=\"filter-text\">最新</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"filter-item\" :class=\"{ active: sortType === 'popular' }\" @click=\"setSort('popular')\">\r\n\t\t\t\t<text class=\"filter-text\">热门</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"filter-item\" :class=\"{ active: sortType === 'rating' }\" @click=\"setSort('rating')\">\r\n\t\t\t\t<text class=\"filter-text\">好评</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 显示加载中状态 -->\r\n\t\t<view v-if=\"loading && reviews.length === 0\" class=\"loading-container\">\r\n\t\t\t<view class=\"loading-spinner\"></view>\r\n\t\t\t<text class=\"loading-text\">加载中...</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 显示无数据状态 -->\r\n\t\t<view v-else-if=\"reviews.length === 0\" class=\"empty-container\">\r\n\t\t\t<text class=\"empty-text\">暂无探店内容</text>\r\n\t\t\t<button class=\"add-review-btn\" @click=\"createReview\">写探店</button>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 探店列表 -->\r\n\t\t<view v-else class=\"reviews-list\">\r\n\t\t\t<view class=\"review-card\" v-for=\"(review, index) in reviews\" :key=\"review.id || index\" @click=\"viewReviewDetail(review.id)\">\r\n\t\t\t\t<view class=\"review-header\">\r\n\t\t\t\t\t<view class=\"user-info\">\r\n\t\t\t\t\t\t<image class=\"user-avatar\" :src=\"review.userAvatar || 'https://ykhyyy.oss-cn-beijing.aliyuncs.com/ht.jpg'\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t\t<view class=\"user-details\">\r\n\t\t\t\t\t\t\t<text class=\"user-name\">{{review.userName || '匿名用户'}}</text>\r\n\t\t\t\t\t\t\t<view class=\"review-rating\">\r\n\t\t\t\t\t\t\t\t<text v-for=\"n in 5\" :key=\"n\" class=\"star\" :class=\"{ active: n <= Math.floor(review.rating || 0) }\">★</text>\r\n\t\t\t\t\t\t\t\t<text class=\"rating-text\">{{review.rating || 0}}分</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<text class=\"review-time\">{{formatDate(review.createTime)}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"review-content\">\r\n\t\t\t\t\t<text class=\"review-title\">{{review.title || '探店体验'}}</text>\r\n\t\t\t\t\t<text class=\"review-text\">{{review.content || '暂无内容'}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view v-if=\"review.images && review.images.length > 0\" class=\"review-images\">\r\n\t\t\t\t\t<image \r\n\t\t\t\t\t\tv-for=\"(img, imgIndex) in review.images.slice(0, 3)\" \r\n\t\t\t\t\t\t:key=\"imgIndex\" \r\n\t\t\t\t\t\t:src=\"img\" \r\n\t\t\t\t\t\tmode=\"aspectFill\" \r\n\t\t\t\t\t\tclass=\"review-image\" \r\n\t\t\t\t\t\t@click.stop=\"previewImage(review.images, imgIndex)\"></image>\r\n\t\t\t\t\t<view v-if=\"review.images.length > 3\" class=\"image-count\">+{{review.images.length - 3}}</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"review-footer\">\r\n\t\t\t\t\t<view class=\"action-btn\" @click.stop=\"likeReview(review, index)\">\r\n\t\t\t\t\t\t<text class=\"action-icon\" :class=\"{ active: review.isLiked }\">👍</text>\r\n\t\t\t\t\t\t<text class=\"action-count\">{{review.likeCount || 0}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"action-btn\" @click.stop=\"commentReview(review.id)\">\r\n\t\t\t\t\t\t<text class=\"action-icon\">💬</text>\r\n\t\t\t\t\t\t<text class=\"action-count\">{{review.commentCount || 0}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"action-btn\" @click.stop=\"shareReview(review.id)\">\r\n\t\t\t\t\t\t<text class=\"action-icon\">🔗</text>\r\n\t\t\t\t\t\t<text class=\"action-text\">分享</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 加载更多 -->\r\n\t\t\t<view v-if=\"hasMore\" class=\"load-more\" @click=\"loadMore\">\r\n\t\t\t\t<text v-if=\"!loadingMore\">加载更多</text>\r\n\t\t\t\t<view v-else class=\"loading-spinner small\"></view>\r\n\t\t\t</view>\r\n\t\t\t<view v-else class=\"no-more\">\r\n\t\t\t\t<text>没有更多探店内容了</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 添加探店按钮 -->\r\n\t\t<view class=\"add-review-floating\" @click=\"createReview\">\r\n\t\t\t<text class=\"add-review-icon\">+</text>\r\n\t\t\t<text class=\"add-review-text\">写探店</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- AI助手组件 -->\r\n\t\t<ai-assistant></ai-assistant>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport AiAssistant from '@/components/AiAssistant.vue';\r\n\timport CustomNavBar from '@/components/CustomNavBar.vue';\r\n\timport config from '@/config/index.js';\r\n\t\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tAiAssistant,\r\n\t\t\tCustomNavBar\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tshopId: null,\r\n\t\t\t\tshopName: '',\r\n\t\t\t\tloading: false,\r\n\t\t\t\tloadingMore: false,\r\n\t\t\t\tcurrentPage: 1,\r\n\t\t\t\tpageSize: 10,\r\n\t\t\t\ttotalItems: 0,\r\n\t\t\t\treviews: [],\r\n\t\t\t\tsortType: 'latest' // 排序类型：latest(最新)、popular(热门)、rating(好评)\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\thasMore() {\r\n\t\t\t\treturn this.reviews.length < this.totalItems;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\tconsole.log('探店页面参数:', JSON.stringify(options));\r\n\t\t\tthis.shopId = options.id;\r\n\t\t\tthis.shopName = decodeURIComponent(options.name || '');\r\n\t\t\t\r\n\t\t\tif (!this.shopId) {\r\n\t\t\t\tconsole.error('未获取到店铺ID');\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '店铺ID无效',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.goBack();\r\n\t\t\t\t}, 1500);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconsole.log('加载店铺探店，ID:', this.shopId);\r\n\t\t\tthis.loadReviews();\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 加载探店评价\r\n\t\t\tloadReviews(refresh = true) {\r\n\t\t\t\tif (refresh) {\r\n\t\t\t\t\tthis.currentPage = 1;\r\n\t\t\t\t\tthis.loading = true;\r\n\t\t\t\t\tthis.reviews = [];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.loadingMore = true;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 构建查询参数\r\n\t\t\t\tconst params = {\r\n\t\t\t\t\tshopId: this.shopId,\r\n\t\t\t\t\tcurrent: this.currentPage,\r\n\t\t\t\t\tsize: this.pageSize\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\t// 根据排序类型添加排序参数\r\n\t\t\t\tif (this.sortType === 'latest') {\r\n\t\t\t\t\tparams.sortBy = 'createTime';\r\n\t\t\t\t\tparams.sortOrder = 'desc';\r\n\t\t\t\t} else if (this.sortType === 'popular') {\r\n\t\t\t\t\tparams.sortBy = 'likeCount';\r\n\t\t\t\t\tparams.sortOrder = 'desc';\r\n\t\t\t\t} else if (this.sortType === 'rating') {\r\n\t\t\t\t\tparams.sortBy = 'rating';\r\n\t\t\t\t\tparams.sortOrder = 'desc';\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconsole.log('请求探店列表参数:', params);\r\n\t\t\t\t\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: `${config.BaseUrl}/api/shop/review/page`,\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\tdata: params,\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'content-type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('获取探店成功:', JSON.stringify(res.data));\r\n\t\t\t\t\t\tif (res.data && res.data.code === 1) {\r\n\t\t\t\t\t\t\tconst data = res.data.data;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (refresh) {\r\n\t\t\t\t\t\t\t\tthis.reviews = data.records || [];\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.reviews = [...this.reviews, ...(data.records || [])];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.totalItems = data.total || 0;\r\n\t\t\t\t\t\t\tthis.currentPage = data.current || 1;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// 处理每个评价的图片数组\r\n\t\t\t\t\t\t\tthis.reviews.forEach(review => {\r\n\t\t\t\t\t\t\t\t// 如果images是字符串，尝试解析为数组\r\n\t\t\t\t\t\t\t\tif (typeof review.images === 'string' && review.images) {\r\n\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\treview.images = JSON.parse(review.images);\r\n\t\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\t\tconsole.error('解析图片JSON失败:', e);\r\n\t\t\t\t\t\t\t\t\t\treview.images = [];\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else if (!review.images) {\r\n\t\t\t\t\t\t\t\t\treview.images = [];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// 为演示添加模拟点赞状态\r\n\t\t\t\t\t\t\t\treview.isLiked = false;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconsole.log(`已加载${this.reviews.length}条探店，总共${this.totalItems}条`);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.error('获取探店API返回错误:', JSON.stringify(res.data));\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '获取探店失败',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('请求失败:', JSON.stringify(err));\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '网络请求失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t\t\tthis.loadingMore = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 设置排序类型\r\n\t\t\tsetSort(sortType) {\r\n\t\t\t\tif (this.sortType === sortType) return;\r\n\t\t\t\tthis.sortType = sortType;\r\n\t\t\t\tthis.loadReviews();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 加载更多\r\n\t\t\tloadMore() {\r\n\t\t\t\tif (!this.loadingMore && this.hasMore) {\r\n\t\t\t\t\tthis.currentPage++;\r\n\t\t\t\t\tthis.loadReviews(false);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 查看探店详情\r\n\t\t\tviewReviewDetail(id) {\r\n\t\t\t\tif (!id) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '探店ID无效',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: `/pages/mall/shops/review-detail?id=${id}`\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 点赞探店\r\n\t\t\tlikeReview(review, index) {\r\n\t\t\t\t// 这里应该调用点赞API，这里只做模拟\r\n\t\t\t\treview.isLiked = !review.isLiked;\r\n\t\t\t\t\r\n\t\t\t\tif (review.isLiked) {\r\n\t\t\t\t\treview.likeCount = (review.likeCount || 0) + 1;\r\n\t\t\t\t} else if (review.likeCount > 0) {\r\n\t\t\t\t\treview.likeCount -= 1;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 更新视图\r\n\t\t\t\tthis.$set(this.reviews, index, review);\r\n\t\t\t\t\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: review.isLiked ? '点赞成功' : '已取消点赞',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 评论探店\r\n\t\t\tcommentReview(id) {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: `/pages/mall/shops/review-detail?id=${id}&showComment=true`\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 分享探店\r\n\t\t\tshareReview(id) {\r\n\t\t\t\tuni.showShareMenu({\r\n\t\t\t\t\twithShareTicket: true\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 创建探店\r\n\t\t\tcreateReview() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: `/pages/mall/shops/create-review?shopId=${this.shopId}&shopName=${encodeURIComponent(this.shopName)}`\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 预览图片\r\n\t\t\tpreviewImage(images, current) {\r\n\t\t\t\tuni.previewImage({\r\n\t\t\t\t\turls: images,\r\n\t\t\t\t\tcurrent: images[current]\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 格式化日期\r\n\t\t\tformatDate(dateStr) {\r\n\t\t\t\tif (!dateStr) return '未知时间';\r\n\t\t\t\t\r\n\t\t\t\tconst date = new Date(dateStr);\r\n\t\t\t\tconst now = new Date();\r\n\t\t\t\tconst diff = now - date;\r\n\t\t\t\t\r\n\t\t\t\t// 小于1分钟\r\n\t\t\t\tif (diff < 60 * 1000) {\r\n\t\t\t\t\treturn '刚刚';\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 小于1小时\r\n\t\t\t\tif (diff < 60 * 60 * 1000) {\r\n\t\t\t\t\treturn `${Math.floor(diff / (60 * 1000))}分钟前`;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 小于1天\r\n\t\t\t\tif (diff < 24 * 60 * 60 * 1000) {\r\n\t\t\t\t\treturn `${Math.floor(diff / (60 * 60 * 1000))}小时前`;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 小于30天\r\n\t\t\t\tif (diff < 30 * 24 * 60 * 60 * 1000) {\r\n\t\t\t\t\treturn `${Math.floor(diff / (24 * 60 * 60 * 1000))}天前`;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 大于30天显示具体日期\r\n\t\t\t\tconst year = date.getFullYear();\r\n\t\t\t\tconst month = date.getMonth() + 1;\r\n\t\t\t\tconst day = date.getDate();\r\n\t\t\t\treturn `${year}-${month < 10 ? '0' + month : month}-${day < 10 ? '0' + day : day}`;\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tgoBack() {\r\n\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\tdelta: 1,\r\n\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\t// If there's no page to go back to, navigate to shop detail\r\n\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\turl: `/pages/mall/shops/detail?id=${this.shopId}`\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 下拉刷新\r\n\t\tonPullDownRefresh() {\r\n\t\t\tthis.loadReviews();\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tuni.stopPullDownRefresh();\r\n\t\t\t}, 1000);\r\n\t\t},\r\n\t\t\r\n\t\t// 上拉加载更多\r\n\t\tonReachBottom() {\r\n\t\t\tthis.loadMore();\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.container {\r\n\t\tbackground-color: #F8F7F2;\r\n\t\tmin-height: 100vh;\r\n\t}\r\n\t\r\n\t.back-button {\r\n\t\tposition: fixed;\r\n\t\ttop: calc(var(--status-bar-height) + 50rpx);\r\n\t\tleft: 30rpx;\r\n\t\tz-index: 1000;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground-color: rgba(255, 255, 255, 0.8);\r\n\t\tpadding: 10rpx 20rpx;\r\n\t\tborder-radius: 30rpx;\r\n\t\tbox-shadow: 0 2rpx 6rpx rgba(0, 0, 0, 0.1);\r\n\t\tborder: 1rpx solid #e0c9d1;\r\n\t}\r\n\t\r\n\t.back-arrow {\r\n\t\tfont-size: 40rpx;\r\n\t\tcolor: #8A3324;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\t\r\n\t.back-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t}\r\n\t\r\n\t/* 顶部信息 */\r\n\t.header-info {\r\n\t\tpadding: 30rpx;\r\n\t\ttext-align: center;\r\n\t}\r\n\t\r\n\t.header-title {\r\n\t\tfont-size: 36rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-weight: bold;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t.header-subtitle {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #666;\r\n\t}\r\n\t\r\n\t/* 筛选选项 */\r\n\t.filter-options {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\tpadding: 0 30rpx 20rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.filter-item {\r\n\t\tpadding: 10rpx 30rpx;\r\n\t\tmargin: 0 10rpx;\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 30rpx;\r\n\t\tborder: 1rpx solid #e0c9d1;\r\n\t}\r\n\t\r\n\t.filter-item.active {\r\n\t\tbackground: rgba(138, 51, 36, 0.1);\r\n\t\tborder-color: #8A3324;\r\n\t}\r\n\t\r\n\t.filter-text {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #666;\r\n\t}\r\n\t\r\n\t.filter-item.active .filter-text {\r\n\t\tcolor: #8A3324;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\t\r\n\t/* 加载状态 */\r\n\t.loading-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding: 60rpx 0;\r\n\t}\r\n\t\r\n\t.loading-spinner {\r\n\t\twidth: 60rpx;\r\n\t\theight: 60rpx;\r\n\t\tborder: 6rpx solid #f3f3f3;\r\n\t\tborder-top: 6rpx solid #7EC4CF;\r\n\t\tborder-radius: 50%;\r\n\t\tanimation: spin 1s linear infinite;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.loading-spinner.small {\r\n\t\twidth: 40rpx;\r\n\t\theight: 40rpx;\r\n\t\tborder-width: 4rpx;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t@keyframes spin {\r\n\t\t0% { transform: rotate(0deg); }\r\n\t\t100% { transform: rotate(360deg); }\r\n\t}\r\n\t\r\n\t.loading-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t.empty-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding: 80rpx 0;\r\n\t}\r\n\t\r\n\t.empty-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #999;\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\t\r\n\t.add-review-btn {\r\n\t\tbackground-color: #8A3324;\r\n\t\tcolor: #fff;\r\n\t\tborder: none;\r\n\t\tborder-radius: 30rpx;\r\n\t\tpadding: 15rpx 30rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: bold;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t}\r\n\t\r\n\t/* 探店列表 */\r\n\t.reviews-list {\r\n\t\tpadding: 0 30rpx 120rpx;\r\n\t}\r\n\t\r\n\t.review-card {\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 15rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 8rpx rgba(0,0,0,0.05);\r\n\t\tborder: 1rpx solid #e0c9d1;\r\n\t}\r\n\t\r\n\t.review-header {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.user-info {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.user-avatar {\r\n\t\twidth: 80rpx;\r\n\t\theight: 80rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tmargin-right: 15rpx;\r\n\t}\r\n\t\r\n\t.user-details {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t}\r\n\t\r\n\t.user-name {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-bottom: 5rpx;\r\n\t}\r\n\t\r\n\t.review-rating {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.star {\r\n\t\tcolor: #DDDDDD;\r\n\t\tfont-size: 24rpx;\r\n\t}\r\n\t\r\n\t.star.active {\r\n\t\tcolor: #FF9500;\r\n\t}\r\n\t\r\n\t.rating-text {\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #FF9500;\r\n\t\tmargin-left: 10rpx;\r\n\t}\r\n\t\r\n\t.review-time {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t.review-content {\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.review-title {\r\n\t\tfont-size: 30rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-bottom: 10rpx;\r\n\t\tdisplay: block;\r\n\t}\r\n\t\r\n\t.review-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t\tline-height: 1.5;\r\n\t}\r\n\t\r\n\t.review-images {\r\n\t\tdisplay: flex;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tposition: relative;\r\n\t}\r\n\t\r\n\t.review-image {\r\n\t\twidth: 180rpx;\r\n\t\theight: 180rpx;\r\n\t\tmargin-right: 10rpx;\r\n\t\tborder-radius: 8rpx;\r\n\t}\r\n\t\r\n\t.image-count {\r\n\t\tposition: absolute;\r\n\t\tright: 10rpx;\r\n\t\tbottom: 10rpx;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 24rpx;\r\n\t\tpadding: 5rpx 10rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t}\r\n\t\r\n\t.review-footer {\r\n\t\tdisplay: flex;\r\n\t\tborder-top: 1rpx solid #f0f0f0;\r\n\t\tpadding-top: 20rpx;\r\n\t}\r\n\t\r\n\t.action-btn {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tmargin-right: 30rpx;\r\n\t}\r\n\t\r\n\t.action-icon {\r\n\t\tfont-size: 32rpx;\r\n\t\tmargin-right: 10rpx;\r\n\t\topacity: 0.7;\r\n\t}\r\n\t\r\n\t.action-icon.active {\r\n\t\topacity: 1;\r\n\t\tcolor: #8A3324;\r\n\t}\r\n\t\r\n\t.action-count, .action-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t/* 浮动添加按钮 */\r\n\t.add-review-floating {\r\n\t\tposition: fixed;\r\n\t\tright: 30rpx;\r\n\t\tbottom: 100rpx;\r\n\t\tbackground-color: #8A3324;\r\n\t\tcolor: #fff;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\twidth: 160rpx;\r\n\t\theight: 80rpx;\r\n\t\tborder-radius: 40rpx;\r\n\t\tbox-shadow: 0 4rpx 10rpx rgba(138, 51, 36, 0.3);\r\n\t\tz-index: 100;\r\n\t}\r\n\t\r\n\t.add-review-icon {\r\n\t\tfont-size: 36rpx;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\t\r\n\t.add-review-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-family: \"FangSong\", serif;\r\n\t}\r\n\t\r\n\t.load-more, .no-more {\r\n\t\ttext-align: center;\r\n\t\tpadding: 30rpx 0;\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n</style> ","import mod from \"-!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./reviews.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../App/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./reviews.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1749279187125\n      var cssReload = require(\"C:/App/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}